[{"path":"https://emmaskarstein.github.io/inlamemi/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 inlamemi authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/articles/Framingham_heart_study.html","id":"first-example-a-logistic-regression-model-with-repeated-measurements","dir":"Articles","previous_headings":"","what":"First example: A logistic regression model with repeated measurements","title":"Influence of systolic blood pressure on coronary heart disease","text":"data model example also used Muff et al (2015), information measurement error model can found . model identical, example just shows can implemented inlamemi. example, fit logistic regression model whether patient heart disease, using systolic blood pressure (SBP) smoking status covariates. SBP measured error, repeated measurements, like feed measurements SBP model. can done easily inlamemi package. formula main model interest logit{𝚍𝚒𝚜𝚎𝚊𝚜𝚎i}=β0+β𝚜𝚋𝚙𝚜𝚋𝚙i+β𝚜𝚖𝚘𝚔𝚒𝚗𝚐𝚜𝚖𝚘𝚔𝚒𝚗𝚐i, \\text{logit}\\{\\texttt{disease}_i\\} = \\beta_0 + \\beta_{\\texttt{sbp}} \\texttt{sbp}_i + \\beta_{\\texttt{smoking}} \\texttt{smoking}_i,  formula imputation model 𝚜𝚋𝚙i=α0+α𝚜𝚖𝚘𝚔𝚒𝚗𝚐𝚜𝚖𝚘𝚔𝚒𝚗𝚐i+εi𝚜𝚋𝚙. \\texttt{sbp}_i = \\alpha_0 + \\alpha_{\\texttt{smoking}} \\texttt{smoking}_i + \\varepsilon_i^{\\texttt{sbp}}.  addition, course also classical measurement error model describes actual error SBP measurements, since repeated measurements actually two: 𝚜𝚋𝚙i1=𝚜𝚋𝚙i+ui1,𝚜𝚋𝚙i2=𝚜𝚋𝚙i+ui2, \\begin{align} \\texttt{sbp}^1_i = \\texttt{sbp}_i + u_i^{1}, \\\\ \\texttt{sbp}^2_i = \\texttt{sbp}_i + u_i^{2}, \\end{align}  ui1,ui2∼N(0,τu)u_i^{1}, u_i^{2} \\sim N(0, \\tau_u) measurement error terms. can call fit_inlamemi function directly formulas model interest imputation model. Also note repeated measurements argument, must set TRUE ensure model specified correctly. give precision error term measurement error model prior, error term imputation model prior. default R-INLA, fixed effects given Gaussian priors mean 00 precision 0.0010.001. re-assign precisions 0.010.01, keep means 0 (therefore specified control.fixed argument). model fit can look summary. comparison, can also fit “naive” model, , model ignores measurement error SBP. model, take average two SBP measurements use SBP variable. can compare estimated coefficients models.","code":"framingham_model <- fit_inlamemi(formula_moi = disease ~ sbp + smoking,                                formula_imp = sbp ~ smoking,                                family_moi = \"binomial\",                                data = framingham,                                error_type = \"classical\",                                repeated_observations = TRUE,                                prior.prec.classical = c(100, 1),                                prior.prec.imp = c(10, 1),                                prior.beta.error = c(0, 0.01),                                initial.prec.classical = 100,                                initial.prec.imp = 10,                                control.fixed = list(                                  prec = list(beta.0 = 0.01,                                              beta.smoking = 0.01,                                              alpha.0 = 0.01,                                              alpha.smoking = 0.01))) summary(framingham_model) #> Formula for model of interest:  #> disease ~ sbp + smoking #>  #> Formula for imputation model:  #> sbp ~ smoking #>  #> Error types:  #> [1] \"classical\" #>  #> Fixed effects for model of interest:  #>                    mean        sd 0.025quant   0.5quant 0.975quant       mode #> beta.0       -2.3615593 0.2704869  -2.893447 -2.3610439 -1.8325961 -2.3610384 #> beta.smoking  0.3993937 0.2994675  -0.187501  0.3992729  0.9869775  0.3992727 #>  #> Coefficient for variable with measurement error and/or missingness:  #>              mean        sd 0.025quant 0.5quant 0.975quant     mode #> beta.sbp 1.897425 0.5598872  0.8404353 1.882702   3.043093 1.816999 #>  #> Fixed effects for imputation model:  #>                          mean         sd  0.025quant    0.5quant 0.975quant        mode #> alpha.sbp.0        0.01454298 0.01858277 -0.02190736  0.01454298 0.05099333  0.01454298 #> alpha.sbp.smoking -0.01958476 0.02156433 -0.06188347 -0.01958476 0.02271395 -0.01958476 #>  #> Model hyperparameters (apart from beta.sbp):  #>                                       mean       sd 0.025quant 0.5quant 0.975quant     mode #> Precision for sbp classical model 75.90178 3.690529   68.89246 75.81334   83.41982 75.63953 #> Precision for sbp imp model       19.89452 1.234087   17.55047 19.86501   22.40730 19.82463 plot(framingham_model) framingham$sbp <- (framingham$sbp1 + framingham$sbp2)/2 naive_model <- inla(formula = disease ~ sbp + smoking,                     family = \"binomial\",                     data = framingham) naive_model$summary.fixed #>                   mean        sd 0.025quant   0.5quant 0.975quant       mode kld #> (Intercept) -2.3547258 0.2692636 -2.8824728 -2.3547258 -1.8269788 -2.3547258   0 #> sbp          1.6686897 0.4937443  0.7009686  1.6686897  2.6364107  1.6686897   0 #> smoking      0.3972557 0.2992211 -0.1892069  0.3972557  0.9837183  0.3972557   0 naive_result <- naive_model$summary.fixed rownames(naive_result) <- c(\"beta.0\", \"beta.sbp\", \"beta.smoking\") naive_result$variable <- rownames(naive_result) me_result <- rbind(summary(framingham_model)$moi_coef[1:6],                    summary(framingham_model)$error_coef[1:6]) me_result$variable <- rownames(me_result) results <- dplyr::bind_rows(naive = naive_result, me_adjusted = me_result, .id = \"model\")  ggplot(results, aes(x = mean, y = model, color = variable)) +   geom_point() +   geom_linerange(aes(xmin = `0.025quant`, xmax = `0.975quant`)) +   facet_grid(~ variable, scales = \"free_x\") +   theme_bw()"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/Framingham_heart_study.html","id":"second-example-heteroscedastic-measurement-error-and-interaction-between-error-variable-and-error-free-variable","dir":"Articles","previous_headings":"","what":"Second example: Heteroscedastic measurement error and interaction between error variable and error free variable","title":"Influence of systolic blood pressure on coronary heart disease","text":"example, artificially increase measurement error smoking group order study model homoscedastic measurement error. model example identical Muff & Keller (2015)","code":"framingham2 <- framingham n <- nrow(framingham2)  set.seed(1) framingham2$sbp1 <- framingham$sbp1 +   ifelse(framingham2$smoking == 1, rnorm(n, 0, 0.117), 0) framingham2$sbp2 <- framingham$sbp2 +   ifelse(framingham2$smoking == 1, rnorm(n, 0, 0.117), 0)  # Or: #framingham2 <- read.table(\"../data-raw/fram_data_case2.txt\", header=T) #names(framingham2) <- c(\"disease\", \"sbp1\", \"sbp2\", \"smoking\")  #framingham2$sbp <- (framingham2$sbp1 + framingham2$sbp2)/2 error_scaling <- c(1/(1+9*framingham2$smoking), 1/(1+9*framingham2$smoking)) # Homoscedastic ME modeled as homoscedastic ME (correct) framingham_model2.1 <- fit_inlamemi(formula_moi = disease ~ sbp:smoking,                                formula_imp = sbp ~ smoking,                                family_moi = \"binomial\",                                data = framingham,                                error_type = \"classical\",                                repeated_observations = TRUE,                                prior.prec.classical = c(100, 1),                                prior.prec.imp = c(10, 1),                                prior.beta.error = c(0, 0.01),                                initial.prec.classical = 100,                                initial.prec.imp = 10,                                control.fixed = list(                                  prec = list(beta.0 = 0.01,                                              beta.smoking = 0.01,                                              alpha.0 = 0.01,                                              alpha.smoking = 0.01)))  # Heteroscedastic ME modeled as heteroscedastic ME (correct) framingham_model2.2 <- fit_inlamemi(formula_moi = disease ~ sbp:smoking,                                formula_imp = sbp ~ smoking,                                family_moi = \"binomial\",                                data = framingham2,                                error_type = \"classical\",                                repeated_observations = TRUE,                                classical_error_scaling = error_scaling,                                prior.prec.classical = c(100, 1),                                prior.prec.imp = c(10, 1),                                prior.beta.error = c(0, 0.01),                                initial.prec.classical = 100,                                initial.prec.imp = 10,                                control.fixed = list(                                  prec = list(beta.0 = 0.01,                                              beta.smoking = 0.01,                                              alpha.0 = 0.01,                                              alpha.smoking = 0.01)))  # Heteroscedastic ME modeled as homoscedastic ME (incorrect) framingham_model2.3 <- fit_inlamemi(formula_moi = disease ~ sbp:smoking,                                formula_imp = sbp ~ smoking,                                family_moi = \"binomial\",                                data = framingham2,                                error_type = \"classical\",                                repeated_observations = TRUE,                                prior.prec.classical = c(100, 1),                                prior.prec.imp = c(10, 1),                                prior.beta.error = c(0, 0.01),                                initial.prec.classical = 100,                                initial.prec.imp = 10,                                control.fixed = list(                                  prec = list(beta.0 = 0.01,                                              beta.smoking = 0.01,                                              alpha.0 = 0.01,                                              alpha.smoking = 0.01)))  framingham_model2.5 <- fit_inlamemi(formula_moi = disease ~ sbp:smoking,                                formula_imp = sbp ~ smoking,                                family_moi = \"binomial\",                                data = framingham2,                                error_type = \"classical\",                                repeated_observations = TRUE,                                classical_error_scaling = c(rep(10^(12), 2*n)),                                prior.prec.classical = c(100, 1),                                prior.prec.imp = c(10, 1),                                prior.beta.error = c(0, 0.01),                                initial.prec.classical = 100,                                initial.prec.imp = 10,                                control.fixed = list(                                  prec = list(beta.0 = 0.01,                                              beta.smoking = 0.01,                                              alpha.0 = 0.01,                                              alpha.smoking = 0.01)))  plot(framingham_model2.1) plot(framingham_model2.2) plot(framingham_model2.3) plot(framingham_model2.5) framingham_model2.1$summary.hyperpar #>                                                 mean       sd 0.025quant  0.5quant 0.975quant      mode #> Precision for the Gaussian observations[2] 75.941763 3.694984 68.9643744 75.839341  83.509525 75.608321 #> Precision for the Gaussian observations[3] 19.900701 1.237511 17.5888076 19.857868  22.459486 19.763236 #> Beta for beta.smokingsbp                   -1.549041 1.354832 -4.1265836 -1.578576   1.205354 -1.708567 #> Beta for beta.sbp                           3.030323 1.193298  0.6201075  3.050937   5.317642  3.140323 framingham_model2.2$summary.hyperpar #>                                                   mean       sd  0.025quant    0.5quant 0.975quant        mode #> Precision for the Gaussian observations[2] 156.9883399 7.229709 143.1926400 156.8372549 171.652037 156.5682728 #> Precision for the Gaussian observations[3]  22.1572213 1.655540  19.0896008  22.0913348  25.604402  21.9514968 #> Beta for beta.smokingsbp                    -0.5231413 1.490996  -3.6739986  -0.4503943   2.171770  -0.1023884 #> Beta for beta.sbp                            2.9651518 1.117829   0.8996622   2.9228739   5.292024   2.7260210 framingham_model2.3$summary.hyperpar #>                                                 mean       sd 0.025quant  0.5quant 0.975quant      mode #> Precision for the Gaussian observations[2] 45.151167 2.190922 40.9948014 45.097007  49.619168 44.986819 #> Precision for the Gaussian observations[3] 19.176661 1.275318 16.7672718 19.141740  21.786114 19.087701 #> Beta for beta.smokingsbp                   -1.556773 1.452213 -4.1875780 -1.626083   1.507422 -1.956430 #> Beta for beta.sbp                           3.240676 1.294155  0.5215732  3.298372   5.600184  3.571394 framingham_model2.5$summary.hyperpar #>                                                     mean           sd    0.025quant      0.5quant   0.975quant          mode #> Precision for the Gaussian observations[2]  5.053238e-11 2.451925e-12  4.585460e-11  5.048081e-11 5.550617e-11  5.039490e-11 #> Precision for the Gaussian observations[3]  1.880235e+01 1.224319e+00  1.650633e+01  1.876300e+01 2.132478e+01  1.868547e+01 #> Beta for beta.smokingsbp                   -1.570571e+00 1.390761e+00 -4.317334e+00 -1.567547e+00 1.158593e+00 -1.555004e+00 #> Beta for beta.sbp                           3.234344e+00 1.245149e+00  7.929082e-01  3.230958e+00 5.695506e+00  3.216894e+00"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/Visualize_model_structure.html","id":"defining-the-model-formula-structured-data-stacks","dir":"Articles","previous_headings":"","what":"Defining the model: formula + structured data stacks","title":"How are the models structured?","text":"using inlamemi package, user specifies two formulas, one main model interest, one imputation model. just two sub-models, also least one measurement error model hood. models need communicated inla() function, takes one formula-argument. formula terms simply added together one big formula, order communicate inla function terms apply sub-model, supply data structured matrices layer matrix shows terms “activated” layer. practice, can done either manually constructed matrices (see instance https://emmaskarstein.github.io/Missing-data--measurement-error/simulation_example.html detailed explanation ), one can use inla.stack function specify modules sub-model separately, stack together. inlamemi package, structure data using inla.stacks. outcome , just makes construction bit generalizable. stack construction done function make_inlamemi_stacks, called fit_inlamemi, function user typically need interact . function show_data_structure converts stack object LaTeX matrices, shows first last row sub-model, making easier get clear overview structure model. Now, take look matrices two different models: one Berkson measurement error, one without.","code":"f_moi <- y ~ x + z f_imp <- x ~ z"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/Visualize_model_structure.html","id":"structure-for-a-classical-measurement-error-model","dir":"Articles","previous_headings":"","what":"Structure for a classical measurement error model","title":"How are the models structured?","text":"models fit inlamemi contain classical measurement error layer, even measurement error, classical model needed technical reasons order covariate imputation. cases classical , scale classical error precision large, thus effectively “turning ” error adjustment keeping imputation model. example, hierarchical model consists main model interest: 𝐲=β0+βx𝐱+βz𝐳+𝛆,𝛆∼N(𝟎,τy𝐈), \\boldsymbol{y} = \\beta_0 + \\beta_x \\boldsymbol{x} + \\beta_z \\boldsymbol{z} + \\boldsymbol{\\varepsilon} \\ , \\quad \\boldsymbol{\\varepsilon} \\sim N(\\boldsymbol{0}, \\tau_y\\boldsymbol{}) \\ ,  classical error model: 𝐰=𝐱+𝐮c,𝐮c∼N(𝟎,τuc𝐈),   \\boldsymbol{w} = \\boldsymbol{x} + \\boldsymbol{u}_c \\ , \\quad \\boldsymbol{u}_c \\sim N(\\boldsymbol{0}, \\tau_{u_c}\\boldsymbol{}) \\ ,  imputation model: 𝐱=α0+αz𝐳+𝛆x,𝛆x∼N(𝟎,τx𝐈). \\boldsymbol{x} = \\alpha_0 + \\alpha_z \\boldsymbol{z} + \\boldsymbol{\\varepsilon}_x \\ , \\quad \\boldsymbol{\\varepsilon}_x \\sim N(\\boldsymbol{0}, \\tau_x\\boldsymbol{}) \\ . need rewritten R-INLA latent effects left hand side: 𝐲=β0+βx𝐱+βz𝐳+𝛆,𝛆∼N(𝟎,τy𝐈),𝐰=𝐱+𝐮c,𝐮c∼N(𝟎,τuc𝐈),𝟎=−𝐱+α0+αz𝐳+𝛆x,𝛆x∼N(𝟎,τx𝐈). \\begin{align}   \\boldsymbol{y} &= \\beta_0 + \\beta_x \\boldsymbol{x} + \\beta_z \\boldsymbol{z} + \\boldsymbol{\\varepsilon} \\ , \\quad &\\boldsymbol{\\varepsilon} \\sim N(\\boldsymbol{0}, \\tau_y\\boldsymbol{}) \\ , \\\\   \\boldsymbol{w} &= \\boldsymbol{x} + \\boldsymbol{u}_c \\ , \\quad &\\boldsymbol{u}_c \\sim N(\\boldsymbol{0}, \\tau_{u_c}\\boldsymbol{}) \\ , \\\\   \\boldsymbol{0} &= -\\boldsymbol{x} + \\alpha_0 + \\alpha_z \\boldsymbol{z} + \\boldsymbol{\\varepsilon}_x \\ , \\quad &\\boldsymbol{\\varepsilon}_x \\sim N(\\boldsymbol{0}, \\tau_x\\boldsymbol{}) \\ . \\end{align}  can construct necessary stacks model using make_inlamemi_stacks function: can visualize data stacks show_data_structure function: LaTeX code stored classical_summary$matrix_string. want display matrices rmarkdown document, can use cat function, just remember set results = 'asis' chunk option. [10.81𝙽𝙰𝙽𝙰⋮⋮⋮6.18𝙽𝙰𝙽𝙰𝙽𝙰4.98𝙽𝙰⋮⋮⋮𝙽𝙰1.46𝙽𝙰𝙽𝙰𝙽𝙰0⋮⋮⋮𝙽𝙰𝙽𝙰0]⏟𝚈=β0[1⋮1𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚋𝚎𝚝𝚊.𝟶+βx[1⋮1000𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚋𝚎𝚝𝚊.𝚡+βz[0.98⋮0.77𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚋𝚎𝚝𝚊.𝚣+[𝙽𝙰⋮𝙽𝙰1⋮1000−1⋮−1000]⏟𝚒𝚍.𝚡+αx,0[𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰1⋮1]⏟𝚊𝚕𝚙𝚑𝚊.𝚡.𝟶+αx,z[𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰0.98⋮0.77]⏟𝚊𝚕𝚙𝚑𝚊.𝚡.𝚣\\underbrace{\\begin{bmatrix}  10.81 & \\texttt{NA} & \\texttt{NA}\\\\ \\vdots & \\vdots & \\vdots\\\\ 6.18 & \\texttt{NA} & \\texttt{NA}\\\\ \\texttt{NA} & 4.98 & \\texttt{NA}\\\\ \\vdots & \\vdots & \\vdots\\\\ \\texttt{NA} & 1.46 & \\texttt{NA}\\\\ \\texttt{NA} & \\texttt{NA} & 0\\\\ \\vdots & \\vdots & \\vdots\\\\ \\texttt{NA} & \\texttt{NA} & 0\\\\ \\end{bmatrix}}_{\\texttt{Y}}  =  \\beta_{0}\\underbrace{\\begin{bmatrix}  1\\\\ \\vdots\\\\ 1\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{beta.0}} + \\beta_{x}\\underbrace{\\begin{bmatrix}  1\\\\ \\vdots\\\\ 1000\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{beta.x}} + \\beta_{z}\\underbrace{\\begin{bmatrix}  0.98\\\\ \\vdots\\\\ 0.77\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{beta.z}} + \\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 1\\\\ \\vdots\\\\ 1000\\\\ -1\\\\ \\vdots\\\\ -1000\\\\ \\end{bmatrix}}_{\\texttt{id.x}} + \\alpha_{x,0}\\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 1\\\\ \\vdots\\\\ 1\\\\ \\end{bmatrix}}_{\\texttt{alpha.x.0}} + \\alpha_{x,z}\\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 0.98\\\\ \\vdots\\\\ 0.77\\\\ \\end{bmatrix}}_{\\texttt{alpha.x.z}}","code":"classical_stack <- make_inlamemi_stacks(data = simple_data,                                       formula_moi = f_moi,                                       formula_imp = f_imp,                                       error_type = \"classical\") classical_summary <- show_data_structure(classical_stack) cat(classical_summary$matrix_string)"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/Visualize_model_structure.html","id":"structure-for-berkson-and-classical-measurement-error-model","dir":"Articles","previous_headings":"","what":"Structure for Berkson and classical measurement error model","title":"How are the models structured?","text":"Next, consider case Berkson measurement error, along either classical , missingness covariate (whether classical , missingness makes difference example, affects scaling measurement error precision). example, hierarchical model consists four levels; main model interest: 𝐲=β0+βx𝐱+βz𝐳+𝛆,𝛆∼N(𝟎,τy𝐈), \\boldsymbol{y} = \\beta_0 + \\beta_x \\boldsymbol{x} + \\beta_z \\boldsymbol{z} + \\boldsymbol{\\varepsilon} \\ , \\quad \\boldsymbol{\\varepsilon} \\sim N(\\boldsymbol{0}, \\tau_y\\boldsymbol{}) \\ ,  Berkson error model: 𝐱=𝐫+𝐮b,𝐮b∼N(𝟎,τub𝐈),   \\boldsymbol{x} = \\boldsymbol{r} + \\boldsymbol{u}_b \\ , \\quad \\boldsymbol{u}_b \\sim N(\\boldsymbol{0}, \\tau_{u_b}\\boldsymbol{}) \\ ,  classical error model: 𝐰=𝐫+𝐮c,𝐮c∼N(𝟎,τuc𝐈),   \\boldsymbol{w} = \\boldsymbol{r} + \\boldsymbol{u}_c \\ , \\quad \\boldsymbol{u}_c \\sim N(\\boldsymbol{0}, \\tau_{u_c}\\boldsymbol{}) \\ ,  imputation model: 𝐫=α0+αz𝐳+𝛆r,𝛆r∼N(𝟎,τr𝐈). \\boldsymbol{r} = \\alpha_0 + \\alpha_z \\boldsymbol{z} + \\boldsymbol{\\varepsilon}_r \\ , \\quad \\boldsymbol{\\varepsilon}_r \\sim N(\\boldsymbol{0}, \\tau_r\\boldsymbol{}) \\ . Notice now new latent variable 𝐫\\boldsymbol{r}, serves link sub-models corresponds variable subject Berkson error yet classical error added. Rewritten R-INLA: 𝐲=β0+βx𝐱+βz𝐳+𝛆,𝛆∼N(𝟎,τy𝐈),𝟎=−𝐱+𝐫+𝐮b,𝐮b∼N(𝟎,τub𝐈),𝐰=𝐫+𝐮c,𝐮c∼N(𝟎,τuc𝐈),𝟎=−𝐫+α0+αz𝐳+𝛆r,𝛆r∼N(𝟎,τr𝐈). \\begin{align}   \\boldsymbol{y} &= \\beta_0 + \\beta_x \\boldsymbol{x} + \\beta_z \\boldsymbol{z} + \\boldsymbol{\\varepsilon} \\ , \\quad &\\boldsymbol{\\varepsilon} &\\sim N(\\boldsymbol{0}, \\tau_y\\boldsymbol{}) \\ , \\\\   \\boldsymbol{0} &= -\\boldsymbol{x} + \\boldsymbol{r} + \\boldsymbol{u}_b \\ , \\quad & \\boldsymbol{u}_b &\\sim N(\\boldsymbol{0}, \\tau_{u_b}\\boldsymbol{}) \\ , \\\\   \\boldsymbol{w} &= \\boldsymbol{r} + \\boldsymbol{u}_c \\ , \\quad &\\boldsymbol{u}_c &\\sim N(\\boldsymbol{0}, \\tau_{u_c}\\boldsymbol{}) \\ , \\\\   \\boldsymbol{0} &= -\\boldsymbol{r} + \\alpha_0 + \\alpha_z \\boldsymbol{z} + \\boldsymbol{\\varepsilon}_r \\ , \\quad &\\boldsymbol{\\varepsilon}_r &\\sim N(\\boldsymbol{0}, \\tau_r\\boldsymbol{}) \\ . \\end{align}  Just like , construct stacks: visualize resulting matrices: [10.81𝙽𝙰𝙽𝙰𝙽𝙰⋮⋮⋮⋮6.18𝙽𝙰𝙽𝙰𝙽𝙰𝙽𝙰0𝙽𝙰𝙽𝙰⋮⋮⋮⋮𝙽𝙰0𝙽𝙰𝙽𝙰𝙽𝙰𝙽𝙰4.98𝙽𝙰⋮⋮⋮⋮𝙽𝙰𝙽𝙰1.46𝙽𝙰𝙽𝙰𝙽𝙰𝙽𝙰0⋮⋮⋮⋮𝙽𝙰𝙽𝙰𝙽𝙰0]⏟𝚈=β0[1⋮1𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚋𝚎𝚝𝚊.𝟶+βx[1⋮1000𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚋𝚎𝚝𝚊.𝚡+βz[0.98⋮0.77𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚋𝚎𝚝𝚊.𝚣+[𝙽𝙰⋮𝙽𝙰−1⋮−1000𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚒𝚍.𝚡+[𝙽𝙰⋮𝙽𝙰1⋮10001⋮1000−1⋮−1000]⏟𝚒𝚍.𝚛+αx,0[𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰1⋮1]⏟𝚊𝚕𝚙𝚑𝚊.𝚡.𝟶+αx,z[𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰0.98⋮0.77]⏟𝚊𝚕𝚙𝚑𝚊.𝚡.𝚣\\underbrace{\\begin{bmatrix}  10.81 & \\texttt{NA} & \\texttt{NA} & \\texttt{NA}\\\\ \\vdots & \\vdots & \\vdots & \\vdots\\\\ 6.18 & \\texttt{NA} & \\texttt{NA} & \\texttt{NA}\\\\ \\texttt{NA} & 0 & \\texttt{NA} & \\texttt{NA}\\\\ \\vdots & \\vdots & \\vdots & \\vdots\\\\ \\texttt{NA} & 0 & \\texttt{NA} & \\texttt{NA}\\\\ \\texttt{NA} & \\texttt{NA} & 4.98 & \\texttt{NA}\\\\ \\vdots & \\vdots & \\vdots & \\vdots\\\\ \\texttt{NA} & \\texttt{NA} & 1.46 & \\texttt{NA}\\\\ \\texttt{NA} & \\texttt{NA} & \\texttt{NA} & 0\\\\ \\vdots & \\vdots & \\vdots & \\vdots\\\\ \\texttt{NA} & \\texttt{NA} & \\texttt{NA} & 0\\\\ \\end{bmatrix}}_{\\texttt{Y}}  =  \\beta_{0}\\underbrace{\\begin{bmatrix}  1\\\\ \\vdots\\\\ 1\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{beta.0}} + \\beta_{x}\\underbrace{\\begin{bmatrix}  1\\\\ \\vdots\\\\ 1000\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{beta.x}} + \\beta_{z}\\underbrace{\\begin{bmatrix}  0.98\\\\ \\vdots\\\\ 0.77\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{beta.z}} + \\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ -1\\\\ \\vdots\\\\ -1000\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{id.x}} + \\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 1\\\\ \\vdots\\\\ 1000\\\\ 1\\\\ \\vdots\\\\ 1000\\\\ -1\\\\ \\vdots\\\\ -1000\\\\ \\end{bmatrix}}_{\\texttt{id.r}} + \\alpha_{x,0}\\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 1\\\\ \\vdots\\\\ 1\\\\ \\end{bmatrix}}_{\\texttt{alpha.x.0}} + \\alpha_{x,z}\\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 0.98\\\\ \\vdots\\\\ 0.77\\\\ \\end{bmatrix}}_{\\texttt{alpha.x.z}} see, things change added another model level, leads another column response matrix, additionally new column latent effect 𝐫\\boldsymbol{r}.","code":"berkson_stack <- make_inlamemi_stacks(data = simple_data,               formula_moi = f_moi,               formula_imp = f_imp,               error_type = c(\"classical\", \"berkson\", \"missing\")) berkson_summary <- show_data_structure(berkson_stack)"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/Visualize_model_structure.html","id":"accessing-the-stacks-from-the-model-object","dir":"Articles","previous_headings":"","what":"Accessing the stacks from the model object","title":"How are the models structured?","text":"data stacks generated make_inlamemi_stacks inside fit_inlamemi also returned inlamemi model object, don’t need run make_inlamemi_stacks . access stacks model object: [10.81𝙽𝙰𝙽𝙰𝙽𝙰⋮⋮⋮⋮6.18𝙽𝙰𝙽𝙰𝙽𝙰𝙽𝙰0𝙽𝙰𝙽𝙰⋮⋮⋮⋮𝙽𝙰0𝙽𝙰𝙽𝙰𝙽𝙰𝙽𝙰4.98𝙽𝙰⋮⋮⋮⋮𝙽𝙰𝙽𝙰1.46𝙽𝙰𝙽𝙰𝙽𝙰𝙽𝙰0⋮⋮⋮⋮𝙽𝙰𝙽𝙰𝙽𝙰0]⏟𝚈=β0[1⋮1𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚋𝚎𝚝𝚊.𝟶+βx[1⋮1000𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚋𝚎𝚝𝚊.𝚡+βz[0.98⋮0.77𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚋𝚎𝚝𝚊.𝚣+[𝙽𝙰⋮𝙽𝙰−1⋮−1000𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚒𝚍.𝚡+[𝙽𝙰⋮𝙽𝙰1⋮10001⋮1000−1⋮−1000]⏟𝚒𝚍.𝚛+αx,0[𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰1⋮1]⏟𝚊𝚕𝚙𝚑𝚊.𝚡.𝟶+αx,z[𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰0.98⋮0.77]⏟𝚊𝚕𝚙𝚑𝚊.𝚡.𝚣\\underbrace{\\begin{bmatrix}  10.81 & \\texttt{NA} & \\texttt{NA} & \\texttt{NA}\\\\ \\vdots & \\vdots & \\vdots & \\vdots\\\\ 6.18 & \\texttt{NA} & \\texttt{NA} & \\texttt{NA}\\\\ \\texttt{NA} & 0 & \\texttt{NA} & \\texttt{NA}\\\\ \\vdots & \\vdots & \\vdots & \\vdots\\\\ \\texttt{NA} & 0 & \\texttt{NA} & \\texttt{NA}\\\\ \\texttt{NA} & \\texttt{NA} & 4.98 & \\texttt{NA}\\\\ \\vdots & \\vdots & \\vdots & \\vdots\\\\ \\texttt{NA} & \\texttt{NA} & 1.46 & \\texttt{NA}\\\\ \\texttt{NA} & \\texttt{NA} & \\texttt{NA} & 0\\\\ \\vdots & \\vdots & \\vdots & \\vdots\\\\ \\texttt{NA} & \\texttt{NA} & \\texttt{NA} & 0\\\\ \\end{bmatrix}}_{\\texttt{Y}}  =  \\beta_{0}\\underbrace{\\begin{bmatrix}  1\\\\ \\vdots\\\\ 1\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{beta.0}} + \\beta_{x}\\underbrace{\\begin{bmatrix}  1\\\\ \\vdots\\\\ 1000\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{beta.x}} + \\beta_{z}\\underbrace{\\begin{bmatrix}  0.98\\\\ \\vdots\\\\ 0.77\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{beta.z}} + \\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ -1\\\\ \\vdots\\\\ -1000\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{id.x}} + \\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 1\\\\ \\vdots\\\\ 1000\\\\ 1\\\\ \\vdots\\\\ 1000\\\\ -1\\\\ \\vdots\\\\ -1000\\\\ \\end{bmatrix}}_{\\texttt{id.r}} + \\alpha_{x,0}\\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 1\\\\ \\vdots\\\\ 1\\\\ \\end{bmatrix}}_{\\texttt{alpha.x.0}} + \\alpha_{x,z}\\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 0.98\\\\ \\vdots\\\\ 0.77\\\\ \\end{bmatrix}}_{\\texttt{alpha.x.z}} [7.9𝙽𝙰𝙽𝙰𝙽𝙰⋮⋮⋮⋮2.58𝙽𝙰𝙽𝙰𝙽𝙰𝙽𝙰2.31𝙽𝙰𝙽𝙰⋮⋮⋮⋮𝙽𝙰𝙽𝙰𝙽𝙰𝙽𝙰𝙽𝙰𝙽𝙰0𝙽𝙰⋮⋮⋮⋮𝙽𝙰𝙽𝙰0𝙽𝙰𝙽𝙰𝙽𝙰𝙽𝙰0⋮⋮⋮⋮𝙽𝙰𝙽𝙰𝙽𝙰1]⏟𝚈=β0[1⋮1𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚋𝚎𝚝𝚊.𝟶+βx[1⋮1000𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚋𝚎𝚝𝚊.𝚡+βz1[0.98⋮0.77𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚋𝚎𝚝𝚊.𝚣𝟷+βz2[−0.05⋮−0.72𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰]⏟𝚋𝚎𝚝𝚊.𝚣𝟸+[𝙽𝙰⋮𝙽𝙰1⋮1000−1⋮−1000𝙽𝙰⋮𝙽𝙰]⏟𝚒𝚍.𝚡+αx,0[𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰1⋮1𝙽𝙰⋮𝙽𝙰]⏟𝚊𝚕𝚙𝚑𝚊.𝚡.𝟶+αx,z1[𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰0.98⋮0.77𝙽𝙰⋮𝙽𝙰]⏟𝚊𝚕𝚙𝚑𝚊.𝚡.𝚣𝟷+γx,0[𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰1⋮1]⏟𝚐𝚊𝚖𝚖𝚊.𝚡.𝟶+γx,z2[𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰−0.05⋮−0.72]⏟𝚐𝚊𝚖𝚖𝚊.𝚡.𝚣𝟸+γx[𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰𝙽𝙰⋮𝙽𝙰1⋮1000]⏟𝚐𝚊𝚖𝚖𝚊.𝚡\\underbrace{\\begin{bmatrix}  7.9 & \\texttt{NA} & \\texttt{NA} & \\texttt{NA}\\\\ \\vdots & \\vdots & \\vdots & \\vdots\\\\ 2.58 & \\texttt{NA} & \\texttt{NA} & \\texttt{NA}\\\\ \\texttt{NA} & 2.31 & \\texttt{NA} & \\texttt{NA}\\\\ \\vdots & \\vdots & \\vdots & \\vdots\\\\ \\texttt{NA} & \\texttt{NA} & \\texttt{NA} & \\texttt{NA}\\\\ \\texttt{NA} & \\texttt{NA} & 0 & \\texttt{NA}\\\\ \\vdots & \\vdots & \\vdots & \\vdots\\\\ \\texttt{NA} & \\texttt{NA} & 0 & \\texttt{NA}\\\\ \\texttt{NA} & \\texttt{NA} & \\texttt{NA} & 0\\\\ \\vdots & \\vdots & \\vdots & \\vdots\\\\ \\texttt{NA} & \\texttt{NA} & \\texttt{NA} & 1\\\\ \\end{bmatrix}}_{\\texttt{Y}}  =  \\beta_{0}\\underbrace{\\begin{bmatrix}  1\\\\ \\vdots\\\\ 1\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{beta.0}} + \\beta_{x}\\underbrace{\\begin{bmatrix}  1\\\\ \\vdots\\\\ 1000\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{beta.x}} + \\beta_{z1}\\underbrace{\\begin{bmatrix}  0.98\\\\ \\vdots\\\\ 0.77\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{beta.z1}} + \\beta_{z2}\\underbrace{\\begin{bmatrix}  -0.05\\\\ \\vdots\\\\ -0.72\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{beta.z2}} + \\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 1\\\\ \\vdots\\\\ 1000\\\\ -1\\\\ \\vdots\\\\ -1000\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{id.x}} + \\alpha_{x,0}\\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 1\\\\ \\vdots\\\\ 1\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{alpha.x.0}} + \\alpha_{x,z1}\\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 0.98\\\\ \\vdots\\\\ 0.77\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\end{bmatrix}}_{\\texttt{alpha.x.z1}} + \\gamma_{x,0}\\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 1\\\\ \\vdots\\\\ 1\\\\ \\end{bmatrix}}_{\\texttt{gamma.x.0}} + \\gamma_{x,z2}\\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ -0.05\\\\ \\vdots\\\\ -0.72\\\\ \\end{bmatrix}}_{\\texttt{gamma.x.z2}} + \\gamma_{x}\\underbrace{\\begin{bmatrix}  \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ \\texttt{NA}\\\\ \\vdots\\\\ \\texttt{NA}\\\\ 1\\\\ \\vdots\\\\ 1000\\\\ \\end{bmatrix}}_{\\texttt{gamma.x}}","code":"inlamemi_model <- fit_inlamemi(data = simple_data,                            formula_moi = f_moi,                            formula_imp = f_imp,                            family_moi = \"gaussian\",                            error_type = c(\"berkson\", \"classical\"),                            prior.prec.moi = c(0.5, 0.5),                            prior.prec.berkson = c(10, 9),                            prior.prec.classical = c(10, 9),                            prior.prec.imp = c(0.5, 0.5),                            initial.prec.moi = 1,                            initial.prec.berkson = 1,                            initial.prec.classical = 1,                            initial.prec.imp = 1)  cat(show_data_structure(inlamemi_model$stack_data)$matrix_string) mis_mod <- fit_inlamemi(formula_moi = y ~ x + z1 + z2,                           formula_imp = x ~ z1,                           formula_mis = m ~ z2 + x,                           family_moi = \"gaussian\",                           data = mar_data,                           error_type = \"missing\",                           prior.beta.error = c(0, 1/1000),                           prior.gamma.error = c(0, 1/1000),                           prior.prec.moi = c(10, 9),                           prior.prec.imp = c(10, 9),                           initial.prec.moi = 1,                           initial.prec.imp = 1) cat(show_data_structure(mis_mod$stack_data)$matrix_string)"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/building_models_without_inlamemi.html","id":"a-short-explanation-of-inla-stack-for-hierarchical-modelling","dir":"Articles","previous_headings":"","what":"A short explanation of inla.stack() for hierarchical modelling","title":"How to avoid using inlamemi","text":"inla.stack() function commonly used spatial modelling stochastic partial differential equations (SPDE), since data bit complex structure. description using stacks context can found chapter 7.3.3 Bayesian inference INLA. However, can also quite useful defining hierarchical models multiple likelihoods, traditionally need defined setting matrices structure matrices encode structure model, explained chapter 6.4 Bayesian inference INLA. stacks eventually converted matrices INLA, modeller may convenient define model stacks. one reason setting matrices need know beginning many levels model, since determines number columns matrices. However, stacks, model level stack, previous stacks change add additional stacks. , definition stacks model level can done independently. inla.stack function takes four arguments: data: list data left side formula (response) : list projector matrices, case non-spatial models just set list(1) effects: list SPDE index covariates, case, just list list containing covariates random effects. tag: character vector labelling group, can useful extracting certain parts stack later.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/articles/building_models_without_inlamemi.html","id":"classical-and-berkson-measurement-error-and-missingness","dir":"Articles","previous_headings":"","what":"Classical and Berkson measurement error and missingness","title":"How to avoid using inlamemi","text":"first example, use dataset simple_data, generated vignette Simulated examples. dataset classical Berkson measurement error, missing data, main model want fit yi=β0+βxxi+βzzi+εi,   y_i = \\beta_0 + \\beta_x x_i + \\beta_z z_i + \\varepsilon_i,  Berkson measurement error 0=−xtrue,+ri+ub,,   0 = -x_{true, } + r_i + u_{b,},  classical measurement error model xi=ri+uc,,   x_i = r_i + u_{c,},  imputation model 0=−ri+α0+αzzi+εr,.   0 = -r_i + \\alpha_0 + \\alpha_z z_i + \\varepsilon_{r,}. begin loading data defining number observations. Next, define priors initial values. inlamemi, fit model like : instead want without inlamemi, start defining stacks model level. main regression model, model yi=β0+βxxi+βzzi+εi,   y_i = \\beta_0 + \\beta_x x_i + \\beta_z z_i + \\varepsilon_i,  defined stack like : Next, Berkson measurement error model 0=−xtrue,+ri+ub,,   0 = -x_{true, } + r_i + u_{b,},  corresponding stack : classical measurement error model xi=ri+uc,,   x_i = r_i + u_{c,}, stack : Finally, imputation model 0=−ri+α0+αzzi+εr,.   0 = -r_i + \\alpha_0 + \\alpha_z z_i + \\varepsilon_{r,}.  corresponding stack stack together, give us matrix formulation also specified manually. model, two latent effects, x r, specified formula. details formula, see supplementary material Skarstein et al (2023), can found online : https://emmaskarstein.github.io/Missing-data--measurement-error/simulation_example.html Finally, call inla() function. model consists four Gaussian sub-models, control.family argument give priors .","code":"data <- simple_data n <- nrow(data) # Prior for beta.x prior.beta <- c(0, 1/1000) # N(0, 10^3)  # Priors for y, measurement error and true x-value precision prior.prec.y <- c(10, 9) prior.prec.u_b <- c(10, 9) prior.prec.u_c <- c(10, 9) prior.prec.r <- c(10, 9)  # Initial values initial.prec.y <- 1 initial.prec.u_b <- 1 initial.prec.u_c <- 1 initial.prec.r <- 1 # Fit the model simple_model <- fit_inlamemi(data = data,                            formula_moi = y ~ x + z,                            formula_imp = x ~ z,                            family_moi = \"gaussian\",                            error_type = c(\"berkson\", \"classical\"),                            prior.prec.moi = prior.prec.y,                            prior.prec.berkson = prior.prec.u_b,                            prior.prec.classical = prior.prec.u_c,                            prior.prec.imp = prior.prec.r,                            initial.prec.moi = initial.prec.y,                            initial.prec.berkson = initial.prec.u_b,                            initial.prec.classical = initial.prec.u_c,                            initial.prec.imp = initial.prec.r) stk_moi <- inla.stack(data = list(y_moi = data$y),                       A = list(1),                       effects = list(                         list(beta.0 = rep(1, n),                              beta.x = 1:n,                              beta.z = data$z)),                       tag = \"moi\") stk_b <- inla.stack(data = list(y_berkson = rep(0, n)),                     A = list(1),                     effects = list(                       list(id.x = 1:n,                            weight.x = -1,                            id.r = 1:n,                            weight.r = 1)),                     tag = \"berkson\") stk_c <- inla.stack(data = list(y_classical = data$x),                     A = list(1),                     effects = list(                       list(id.r = 1:n,                            weight.r = 1)),                     tag = \"classical\") stk_imp <- inla.stack(data = list(y_imp = rep(0, n)),                       A = list(1),                       effects = list(                         list(id.r = 1:n,                              weight.r = rep(-1, n),                              alpha.0 = rep(1, n),                              alpha.z = data$z)),                       tag = \"imputation\") stk_full <- inla.stack(stk_moi, stk_b, stk_c, stk_imp) formula <- list(y_moi, y_berkson, y_classical, y_imp) ~ - 1 + beta.0 + beta.z +   f(beta.x, copy = \"id.x\",     hyper = list(beta = list(param = c(0, 1/1000), fixed = FALSE))) +   f(id.x, weight.x, model = \"iid\", values = 1:n,     hyper = list(prec = list(initial = -15, fixed = TRUE))) +   f(id.r, weight.r, model=\"iid\", values = 1:n,     hyper = list(prec = list(initial = -15, fixed = TRUE))) +   alpha.0 + alpha.z model_sim <- inla(formula, data = inla.stack.data(stk_full),                   family = c(\"gaussian\", \"gaussian\", \"gaussian\", \"gaussian\"),                   control.family = list(                     list(hyper = list(prec = list(initial = log(initial.prec.y),                                                   param = prior.prec.y,                                                   fixed = FALSE))),                     list(hyper = list(prec = list(initial = log(initial.prec.u_b),                                                   param = prior.prec.u_b,                                                   fixed = FALSE))),                     list(hyper = list(prec = list(initial = log(initial.prec.u_c),                                                   param = prior.prec.u_c,                                                   fixed = FALSE))),                     list(hyper = list(prec = list(initial = log(initial.prec.r),                                                   param = prior.prec.r,                                                   fixed = FALSE)))                   ),                   control.predictor = list(compute = TRUE) )  summary(model_sim) #> Time used: #>     Pre = 1.87, Running = 2.34, Post = 0.176, Total = 4.38  #> Fixed effects: #>          mean    sd 0.025quant 0.5quant 0.975quant  mode kld #> beta.0  1.030 0.219      0.612    1.029      1.435 1.025   0 #> beta.z  1.911 0.388      1.225    1.901      2.560 1.910   0 #> alpha.0 1.033 0.051      0.934    1.033      1.132 1.033   0 #> alpha.z 2.025 0.052      1.922    2.025      2.127 2.025   0 #>  #> Random effects: #>   Name     Model #>     id.x IID model #>    id.r IID model #>    beta.x Copy #>  #> Model hyperparameters: #>                                             mean    sd 0.025quant 0.5quant 0.975quant  mode #> Precision for the Gaussian observations    1.128 0.365      0.556    1.080       1.98 0.992 #> Precision for the Gaussian observations[2] 1.127 0.355      0.581    1.076       1.96 0.983 #> Precision for the Gaussian observations[3] 0.927 0.111      0.729    0.920       1.17 0.905 #> Precision for the Gaussian observations[4] 0.977 0.128      0.749    0.969       1.25 0.954 #> Beta for beta.x                            1.972 0.207      1.559    1.974       2.38 1.981 #>  #> Marginal log-Likelihood:  -20699.96  #>  is computed  #> Posterior summaries for the linear predictor and the fitted values are computed #> (Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/building_models_without_inlamemi.html","id":"a-model-for-missing-data-missing-not-at-random","dir":"Articles","previous_headings":"","what":"A model for missing data, missing not at random","title":"How to avoid using inlamemi","text":"example, dealing missing data, show include another level model potentially capture missingness mechanism may depend available covariates. dataset, simulated , let value covariate x missingness depend another covariate z1 (corresponding imputation model), probability entry x missing depends another covariate z2 (corresponding missingness model). main model interest case yi=β0+βxxtrue,+βz1z1,+βz2z2,+εi, y_i = \\beta_0 + \\beta_x x_{true,} + \\beta_{z_1} z_{1,} + \\beta_{z_2} z_{2,} + \\varepsilon_i ,  stack : classical measurement error just functioning link case, model xobs,=xtrue,+uc,,   x_{obs, } = x_{true, } + u_{c,},  precision uc,iu_{c,} set high ii xobs,ix_{obs,} observed. stack level : Next imputation model 0=−xtrue,+α0+αz1z1,+εx,,   0 = -x_{true,} + \\alpha_0 + \\alpha_{z_1} z_{1,} + \\varepsilon_{x,},  stack missingness model binomial model describing probability missing, pmp_m, may depend covariates. model logit(pm,)=γ0+γxxtrue,+γz2z2,,   \\text{logit}(p_{m,}) = \\gamma_0 + \\gamma_x x_{true,} + \\gamma_{z_2} z_{2,},  stack : join stacks together: defining formula, now need define hyperparameter gamma.x, way define beta.x. scaled copy id.x. Since don’t measurement error case, set precision high classical error model argument scale. Looking summary, importantly, note model picks gamma.0 gamma.z2, defined -1.5 -0.5, respectively. data simulation, construct missingness x depend value x, correspond “missing random” mechanism. fact missingness x depends observed covariates indicates “missing random” mechanism (simulated ). missingness x depend covariates, “missing completely random”.","code":"set.seed(2024) n <- 1000  z1 <- rnorm(n, mean = 0, sd = 1) z2 <- rnorm(n, mean = 0, sd = 1)  alpha.0 <- 1; alpha.z1 <- 0.3 x <- rnorm(n, mean = alpha.0 + alpha.z1*z1, sd = 1)  gamma.0 <- -1.5; gamma.z2 <- -0.5 m_pred <- gamma.0 + gamma.z2*z2 m_prob <- exp(m_pred)/(1 + exp(m_pred)) m <- as.logical(rbinom(n, 1, prob = m_prob)) x_obs <- x x_obs[m] <- NA  sum(is.na(x_obs))/length(x_obs) #> [1] 0.183 beta.0 <- 1; beta.x <- 2; beta.z1 <- 2; beta.z2 <- 2 y <- beta.0 + beta.x*x + beta.z1*z1 + beta.z2*z2 + rnorm(n)  missing_data <- data.frame(y = y, x = x_obs, x_true = x, z1 = z1, z2 = z2) stk_moi <- inla.stack(data = list(y_moi = missing_data$y),                       A = list(1),                       effects = list(                         list(beta.0 = rep(1, n),                              beta.x = 1:n,                              beta.z1 = missing_data$z1,                              beta.z2 = missing_data$z2)),                       tag = \"moi\") stk_c <- inla.stack(data = list(y_classical = missing_data$x),                     A = list(1),                     effects = list(                       list(id.x = 1:n,                            weight.x = 1)),                     tag = \"classical\") stk_imp <- inla.stack(data = list(y_imp = rep(0, n)),                       A = list(1),                       effects = list(                         list(id.x = 1:n,                              weight.x = -1,                              alpha.0 = rep(1, n),                              alpha.z1 = missing_data$z1)),                       tag = \"imputation\") stk_mis <- inla.stack(data = list(y_mis = as.numeric(is.na(missing_data$x))),                       A = list(1),                       effects = list(                         list(gamma.x = 1:n,                              gamma.0 = rep(1, n),                              gamma.z2 = missing_data$z2)),                       tag = \"missingness\") stk_full <- inla.stack(stk_moi, stk_c, stk_imp, stk_mis) formula <- list(y_moi, y_classical, y_imp, y_mis) ~ - 1 +   beta.0 + beta.z1 + beta.z2 +   f(beta.x, copy = \"id.x\",     hyper = list(beta = list(param = c(0, 1/1000), fixed = FALSE))) +   f(id.x, weight.x, model = \"iid\", values = 1:n,     hyper = list(prec = list(initial = -15, fixed = TRUE))) +   f(gamma.x, copy = \"id.x\",     hyper = list(beta = list(param = c(0, 1/1000), fixed = FALSE))) +   alpha.0 + alpha.z1 + gamma.0 + gamma.z2 model_mnar <- inla(formula, data = inla.stack.data(stk_full),                   family = c(\"gaussian\", \"gaussian\", \"gaussian\", \"binomial\"),                   scale = c(rep(1, n), rep(10^8, n), rep(1, n), rep(1, n)),                   control.family = list(                     list(hyper = list(prec = list(initial = log(1),                                                   param = c(10, 9),                                                   fixed = FALSE))),                     list(hyper = list(prec = list(initial = log(1),                                                   param = c(10, 9),                                                   fixed = FALSE))),                     list(hyper = list(prec = list(initial = log(1),                                                   param = c(10, 9),                                                   fixed = FALSE))),                     list()),                   control.predictor = list(compute = TRUE, link = 1) )  summary(model_mnar) #> Time used: #>     Pre = 1.9, Running = 3.8, Post = 0.175, Total = 5.88  #> Fixed effects: #>            mean    sd 0.025quant 0.5quant 0.975quant   mode kld #> beta.0    1.038 0.050      0.940    1.038      1.136  1.038   0 #> beta.z1   2.004 0.036      1.933    2.004      2.075  2.004   0 #> beta.z2   1.985 0.036      1.914    1.985      2.057  1.985   0 #> alpha.0   1.011 0.032      0.947    1.011      1.074  1.011   0 #> alpha.z1  0.292 0.033      0.228    0.292      0.355  0.292   0 #> gamma.0  -1.510 0.122     -1.754   -1.509     -1.275 -1.509   0 #> gamma.z2 -0.425 0.088     -0.597   -0.425     -0.252 -0.425   0 #>  #> Random effects: #>   Name     Model #>     id.x IID model #>    beta.x Copy #>    gamma.x Copy #>  #> Model hyperparameters: #>                                              mean    sd 0.025quant 0.5quant 0.975quant   mode #> Precision for the Gaussian observations     0.983 0.048      0.890    0.983      1.079  0.984 #> Precision for the Gaussian observations[2]  1.130 0.357      0.590    1.077      1.981  0.977 #> Precision for the Gaussian observations[3]  1.023 0.047      0.932    1.022      1.119  1.020 #> Beta for beta.x                             1.953 0.035      1.884    1.953      2.021  1.955 #> Beta for gamma.x                           -0.036 0.089     -0.213   -0.036      0.138 -0.034 #>  #> Marginal log-Likelihood:  -11663.19  #>  is computed  #> Posterior summaries for the linear predictor and the fitted values are computed #> (Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"simple-example-with-missingness-and-two-types-of-measurement-error","dir":"Articles","previous_headings":"","what":"Simple example with missingness and two types of measurement error","title":"Simulated examples","text":"simple simulation Berkson classical error well missing data, check package works expected scenario.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"generating-the-data","dir":"Articles","previous_headings":"Simple example with missingness and two types of measurement error","what":"Generating the data","title":"Simulated examples","text":"","code":"set.seed(2024) n <- 1000  # Covariate without error: z <- rnorm(n, mean = 0, sd = 1)  # Berkson error: u_b <- rnorm(n, sd = 1) alpha.0 <- 1; alpha.z <- 2 r <- rnorm(n, mean = alpha.0 + alpha.z*z, sd = 1) x <- r + u_b # Turn off Berkson by commenting out \"+ u_b\"  # Response: beta.0 <- 1; beta.x <- 2; beta.z <- 2 y <- beta.0 + beta.x*x + beta.z*z + rnorm(n)  # Classical error: u_c <- rnorm(n, sd = 1) x_obs <- r + u_c   # Missingness: m_pred <- -1.5 - 0.5*z # This gives a mean probability of missing of ca 0.2. m_prob <- exp(m_pred)/(1 + exp(m_pred))  m_index <- as.logical(rbinom(n, 1, prob = m_prob)) # MAR # m_index <- sample(1:n, 0.2*n, replace = FALSE) # MCAR x_obs[m_index] <- NA  simple_data <- data.frame(y = y, x = x_obs, z = z)"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"fitting-the-model","dir":"Articles","previous_headings":"Simple example with missingness and two types of measurement error","what":"Fitting the model","title":"Simulated examples","text":"plot chunk unnamed-chunk-4","code":"# Fit the model simple_model <- fit_inlamemi(data = simple_data,                           formula_moi = y ~ x + z,                           formula_imp = x ~ z,                           family_moi = \"gaussian\",                          error_type = c(\"berkson\", \"classical\"),                          prior.prec.moi = c(10, 9),       # Gamma(10, 9)                          prior.prec.berkson = c(10, 9),   # Gamma(10, 9)                          prior.prec.classical = c(10, 9), # Gamma(10, 9)                          prior.prec.imp = c(10, 9),       # Gamma(10, 9)                          prior.beta.error = c(0, 1/1000), # N(0, 10^3)                          initial.prec.moi = 1,                          initial.prec.berkson = 1,                          initial.prec.classical = 1,                          initial.prec.imp = 1) summary(simple_model) #> Formula for model of interest:  #> y ~ x + z #>  #> Formula for imputation model:  #> x ~ z #>  #> Error types:  #> [1] \"berkson\"   \"classical\" #>  #> Fixed effects for model of interest:  #>            mean        sd 0.025quant 0.5quant 0.975quant     mode #> beta.0 1.027602 0.2186511  0.6083084 1.025492   1.436240 1.020619 #> beta.z 1.906201 0.3876191  1.2160591 1.893875   2.558432 1.903803 #>  #> Coefficient for variable with measurement error and/or missingness:  #>            mean        sd 0.025quant 0.5quant 0.975quant     mode #> beta.x 1.973221 0.2015696   1.570253 1.975306   2.363884 1.984143 #>  #> Fixed effects for imputation model:  #>               mean         sd 0.025quant 0.5quant 0.975quant     mode #> alpha.x.0 1.033079 0.05058874  0.9338329 1.033087   1.132280 1.033087 #> alpha.x.z 2.024709 0.05225086  1.9222764 2.024692   2.127243 2.024692 #>  #> Model hyperparameters (apart from beta.x):  #>                                      mean        sd 0.025quant  0.5quant 0.975quant      mode #> Precision for model of interest 1.1289547 0.3578772  0.5722733 1.0802543   1.965920 0.9906998 #> Precision for x berkson model   1.1271920 0.3433899  0.5920915 1.0807322   1.930556 0.9946972 #> Precision for x classical model 0.9260566 0.1084821  0.7324524 0.9192407   1.158996 0.9047465 #> Precision for x imp model       0.9779655 0.1252989  0.7530223 0.9705594   1.245496 0.9569073 simple.truth <- tibble::tribble(   ~\"variable\", ~\"value\",   \"beta.x\",  beta.x,    \"beta.z\",  beta.z,  #  \"beta.0\",  beta.0,    \"alpha.x.z\", alpha.z,   # \"alpha.0\", alpha.0   )  plot(simple_model, plot_intercepts = FALSE) +     geom_point(data = simple.truth, aes(x = value))"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"missing-data-only","dir":"Articles","previous_headings":"","what":"Missing data only","title":"Simulated examples","text":"example, missingness one covariate, measurement error, shows simple imputation missing covariate R-INLA.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"generating-the-data-1","dir":"Articles","previous_headings":"Missing data only","what":"Generating the data","title":"Simulated examples","text":"","code":"set.seed(2024) n <- 1000  # Covariate without missingness: z <- rnorm(n, mean = 0, sd = 1)  # Covariate that will have missingness: alpha.0 <- 1; alpha.z <- 2 x <- rnorm(n, mean = alpha.0 + alpha.z*z, sd = 1)  # Response: beta.0 <- 1; beta.x <- 2; beta.z <- 2 y <- beta.0 + beta.x*x + beta.z*z + rnorm(n)  # Missingness: m_pred <- -1.5 - 0.5*z # This gives a mean probability of missing of ca 0.2. m_prob <- exp(m_pred)/(1 + exp(m_pred))  m_index <- as.logical(rbinom(n, 1, prob = m_prob)) # MAR # m_index <- sample(1:n, 0.2*n, replace = FALSE) # MCAR x_obs <- x x_obs[m_index] <- NA  missing_data <- data.frame(y = y, x = x_obs, z = z)"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"model-without-imputation","dir":"Articles","previous_headings":"Missing data only","what":"Model without imputation","title":"Simulated examples","text":"","code":"naive_model <- inla(formula = y ~ x + z, family = \"gaussian\", data = missing_data)  naive_model$summary.fixed #>                 mean         sd 0.025quant 0.5quant 0.975quant     mode          kld #> (Intercept) 2.059952 0.07313492  1.9165113 2.059952   2.203392 2.059952 1.012936e-11 #> x           1.060038 0.04847764  0.9649586 1.060038   1.155118 1.060038 1.018066e-11 #> z           4.242952 0.09766027  4.0514099 4.242952   4.434494 4.242952 1.033686e-11 naive_model$summary.hyperpar #>                                              mean         sd 0.025quant 0.5quant 0.975quant      mode #> Precision for the Gaussian observations 0.3082829 0.01379352  0.2818484 0.308078  0.3359021 0.3076677"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"model-with-imputation","dir":"Articles","previous_headings":"Missing data only","what":"Model with imputation","title":"Simulated examples","text":"plot chunk unnamed-chunk-8","code":"missing_model <- fit_inlamemi(formula_moi = y ~ x + z,                             formula_imp = x ~ z,                             family_moi = \"gaussian\",                             data = missing_data,                              error_type = \"missing\",                              prior.prec.moi = c(2, 1),                             prior.prec.imp = c(2, 1),                             prior.beta.error = c(0, 1/1000),                             initial.prec.moi = 1,                             initial.prec.imp = 1)  summary(missing_model) #> Formula for model of interest:  #> y ~ x + z #>  #> Formula for imputation model:  #> x ~ z #>  #> Error types:  #> [1] \"missing\" #>  #> Fixed effects for model of interest:  #>             mean         sd 0.025quant  0.5quant 0.975quant      mode #> beta.0 0.9735076 0.04830102  0.8800577 0.9733148   1.067603 0.9731718 #> beta.z 1.9432463 0.07576310  1.7996969 1.9421270   2.088043 1.9412456 #>  #> Coefficient for variable with measurement error and/or missingness:  #>            mean         sd 0.025quant 0.5quant 0.975quant     mode #> beta.x 2.024994 0.03435627   1.956587 2.025256   2.091859 2.026359 #>  #> Fixed effects for imputation model:  #>               mean         sd 0.025quant 0.5quant 0.975quant     mode #> alpha.x.0 1.031090 0.03135672  0.9695993 1.031087   1.092600 1.031087 #> alpha.x.z 1.983403 0.03205811  1.9205258 1.983404   2.046277 1.983404 #>  #> Model hyperparameters (apart from beta.x):  #>                                     mean         sd 0.025quant 0.5quant 0.975quant      mode #> Precision for model of interest 1.056684 0.05223063  0.9570575 1.055579   1.162652 1.0537658 #> Precision for x classical model 1.143309 0.34507593  0.6479685 1.084275   1.989363 0.9643537 #> Precision for x imp model       1.065744 0.04963685  0.9696392 1.065177   1.165013 1.0653465 missing_truth <- tibble::tribble(   ~\"variable\", ~\"value\",   \"beta.0\", beta.0,   \"beta.x\",  beta.x,    \"beta.z\",  beta.z,   \"alpha.x.0\", alpha.0,   \"alpha.x.z\", alpha.z )  plot(missing_model) +     geom_point(data = missing_truth, aes(x = value))"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"random-effect-in-the-main-model","dir":"Articles","previous_headings":"","what":"Random effect in the main model","title":"Simulated examples","text":"example, simulate data grouped way modelled random effect model interest.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"generating-the-data-2","dir":"Articles","previous_headings":"Random effect in the main model","what":"Generating the data","title":"Simulated examples","text":"","code":"m <- 10 # number of groups n <- 100 # number of observations per group N <- m*n # total number of observations  sd_y <- 3 # sd for the noise sd_w <- 2 # sd for random effect sd_x <- 2 # sd for covariate without error sd_u <- 1 # sd for measurement error  # Covariate without error z <- rnorm(N, 0, 2)  # Covariate with error x <- rnorm(N, 0, sd_x) # Independent of z, but can change that here x_obs <- x + rnorm(N, 0, sd_u)  # Random effect w_per_group <- rnorm(m, 0, sd_w) w <- rep(w_per_group, each = n)  # Response y <- 1 + 2*x + 2*z + w + rnorm(N, 0, sd_y)  reff_data <- data.frame(y = y, id = rep(1:m, each = n), x = x_obs, z = z)"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"fitting-the-model-1","dir":"Articles","previous_headings":"Random effect in the main model","what":"Fitting the model","title":"Simulated examples","text":"Firstly, ignored measurement error, might fit model like : plot chunk unnamed-chunk-11","code":"naive_model <- inla(y ~ x + z + f(id, model = \"iid\"),                     data = reff_data,                     family = \"gaussian\") summary(naive_model) #> Time used: #>     Pre = 1.63, Running = 0.679, Post = 0.0465, Total = 2.36  #> Fixed effects: #>               mean    sd 0.025quant 0.5quant 0.975quant   mode kld #> (Intercept) -0.316 0.560     -1.429   -0.316      0.796 -0.316   0 #> x            1.682 0.051      1.582    1.682      1.782  1.682   0 #> z            2.022 0.058      1.908    2.022      2.136  2.022   0 #>  #> Random effects: #>   Name     Model #>     id IID model #>  #> Model hyperparameters: #>                                          mean    sd 0.025quant 0.5quant 0.975quant  mode #> Precision for the Gaussian observations 0.077 0.003      0.070    0.077      0.084 0.077 #> Precision for id                        0.401 0.184      0.145    0.367      0.852 0.305 #>  #> Marginal log-Likelihood:  -2756.06  #>  is computed  #> Posterior summaries for the linear predictor and the fitted values are computed #> (Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)') # curve(dgamma(x, shape = 1.5, rate = 2), to = 2)  reff_model <- fit_inlamemi(formula_moi = y ~ x + z +                           f(id, model = \"iid\", hyper = list(prec = list(initial = -15, param = c(2, 2)))),                        formula_imp = x ~ 1,                        family_moi = \"gaussian\",                        error_type = \"classical\",                        data = reff_data,                        initial.prec.moi = 1/4,                         initial.prec.classical = 1,                         initial.prec.imp = 1/4,                        prior.prec.moi = c(1, 4),                        prior.prec.classical = c(10, 10),                        prior.prec.imp = c(1, 4),                        prior.beta.error = c(0, 1/1000))  summary(reff_model) #> Formula for model of interest:  #> y ~ x + z + f(id, model = \"iid\", hyper = list(prec = list(initial = -15,  #>     param = c(2, 2)))) #>  #> Formula for imputation model:  #> x ~ 1 #>  #> Error types:  #> [1] \"classical\" #>  #> Fixed effects for model of interest:  #>              mean         sd 0.025quant   0.5quant 0.975quant       mode #> beta.0 -0.3659492 0.54014774  -1.440257 -0.3661872  0.7098422 -0.3661385 #> beta.z  2.0223038 0.05791576   1.908708  2.0223069  2.1358823  2.0223069 #>  #> Coefficient for variable with measurement error and/or missingness:  #>            mean        sd 0.025quant 0.5quant 0.975quant     mode #> beta.x 2.136576 0.1978989    1.75516 2.133829   2.534286 2.122058 #>  #> Fixed effects for imputation model:  #>                mean        sd  0.025quant  0.5quant 0.975quant      mode #> alpha.x.0 0.1022764 0.0711425 -0.03725084 0.1022764  0.2418037 0.1022764 #>  #> Model hyperparameters (apart from beta.x):  #>                                      mean         sd 0.025quant  0.5quant 0.975quant      mode #> Precision for model of interest 0.1111287 0.02063900 0.07677898 0.1090154  0.1577547 0.1045383 #> Precision for x classical model 0.9863541 0.33507883 0.47537156 0.9376203  1.7781313 0.8478562 #> Precision for x imp model       0.2526082 0.02629019 0.20565550 0.2509687  0.3090606 0.2471533 #> Precision for id                0.4122585 0.16678697 0.16510576 0.3857361  0.8099128 0.3358915 reff.truth <- tibble::tribble(   ~\"variable\", ~\"value\",   \"beta.x\",  2,    \"beta.z\",  2,    \"beta.0\",  1,    \"alpha.x.0\", 0 )  plot(reff_model) +     geom_point(data = reff.truth, aes(x = value))"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"interaction-effect-with-error-variable","dir":"Articles","previous_headings":"","what":"Interaction effect with error variable","title":"Simulated examples","text":"Interaction effects error prone variable (assumed) error-free variable can also used. syntax normal, interaction effect variables x s specified formula model interest x:s.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"generating-the-data-3","dir":"Articles","previous_headings":"Interaction effect with error variable","what":"Generating the data","title":"Simulated examples","text":"","code":"set.seed(2024) n <- 1000  # Covariate without error: s <- c(rep(0, n/2), rep(1, n/2))  # Classical error: x <- rnorm(n, mean = 0, sd = 2) u_c <- rnorm(n, sd = 1) x_obs <- x + u_c   # Response: beta.0 <- 1; beta.x.s <- 2 y <- beta.0 + beta.x*x + beta.x.s*x_obs*s + rnorm(n)  interact_data <- data.frame(y = y, x = x_obs, z = z, s = s)"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"fitting-the-model-2","dir":"Articles","previous_headings":"Interaction effect with error variable","what":"Fitting the model","title":"Simulated examples","text":"plot chunk unnamed-chunk-14","code":"interact_model <- fit_inlamemi(formula_moi = y ~ x:s,                              formula_imp = x ~ 1,                              family_moi = \"gaussian\",                              data = interact_data,                              error_type = \"classical\",                              prior.beta.error = c(0, 0.01),                              prior.prec.moi = c(10, 9),                              prior.prec.classical = c(10, 9),                              prior.prec.imp = c(10, 8),                              initial.prec.moi = 1,                              initial.prec.classical = 1,                              initial.prec.imp = 2) summary(interact_model) #> Formula for model of interest:  #> y ~ x:s #>  #> Formula for imputation model:  #> x ~ 1 #>  #> Error types:  #> [1] \"classical\" #>  #> Fixed effects for model of interest:  #>               mean         sd 0.025quant    0.5quant 0.975quant        mode #> beta.0  1.00806625 0.07957354  0.8519766  1.00806929  1.1641390  1.00806941 #> beta.s -0.08599411 0.13378176 -0.3483978 -0.08598926  0.1763819 -0.08598926 #>  #> Coefficient for variable with measurement error and/or missingness:  #>             mean         sd 0.025quant 0.5quant 0.975quant     mode #> beta.sx 2.055651 0.06317748   1.931571 2.055549   2.180323 2.055127 #> beta.x  1.709734 0.04039037   1.630268 1.709716   1.789299 1.709645 #>  #> Fixed effects for imputation model:  #>                 mean         sd  0.025quant   0.5quant 0.975quant       mode #> alpha.x.0 0.03481148 0.06849579 -0.09952965 0.03481148  0.1691526 0.03481148 #>  #> Model hyperparameters (apart from beta.sx, beta.x):  #>                                      mean         sd 0.025quant  0.5quant 0.975quant      mode #> Precision for model of interest 0.4107183 0.03317928  0.3491489 0.4094301  0.4796973 0.4069626 #> Precision for x classical model 4.1014561 0.43981351  3.3020907 4.0787164  5.0316880 4.0349042 #> Precision for x imp model       0.2252702 0.01058364  0.2050005 0.2250743  0.2466613 0.2247959 plot(interact_model)"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"logistic-regression-with-classical-error-and-missing-data","dir":"Articles","previous_headings":"","what":"Logistic regression with classical error and missing data","title":"Simulated examples","text":"show fit logistic regression model. Modeling error missing data:","code":"set.seed(1) nn <- 1000  z <- rbinom(nn, 1, 0.5) x <- rnorm(nn, 1-0.5*z, 1)  # Error w <- x + rnorm(nn, 0, 1)  # Generating missing data, depending on z eta <- -1 + z prob_missing <- exp(eta)/(1 + exp(eta)) missing_index <- rbinom(nn, 1, prob_missing)  # Proportion missing: sum(missing_index)/nn #> [1] 0.393 # Replace the values in w by missing in case the index for missingness is =1: w <- ifelse(missing_index==1, NA, w)  # Generate binomial response eta <- x + z  prob <- exp(eta)/(1 + exp(eta)) y <- rbinom(nn, 1, prob)  data_binom <- data.frame(x = x, z = z, y = y, w = w) model_binom <- fit_inlamemi(data = data_binom,                        formula_moi = y ~ w + z,                        formula_imp = w ~ z,                        formula_mis = m ~ z,                        family_moi = \"binomial\",                        error_type = c(\"classical\",\"missing\"),                        prior.prec.classical = c(10, 9),                        prior.prec.imp = c(10, 9),                        prior.beta.error = c(0, 1/1000),                        initial.prec.classical = 2,                        initial.prec.imp = 1)  summary(model_binom) plot(model_binom)"},{"path":"https://emmaskarstein.github.io/inlamemi/articles/simulated_examples.html","id":"poisson-regression-with-classical-error-and-missing-data","dir":"Articles","previous_headings":"","what":"Poisson regression with classical error and missing data","title":"Simulated examples","text":"show fit Poisson regression model, model interest random intercept term. Simple regression models correct error-prone variables check effect: Modeling error missing data:","code":"set.seed(1) nn <- 1000  z <- rbinom(nn, 1, 0.5) x <- rnorm(nn, 1-0.5*z, 1)  # Error w <- x + rnorm(nn, 0, 1)  # Generating missing data, depending on z eta <- -1 + z prob_missing <- exp(eta)/(1 + exp(eta)) missing_index <- rbinom(nn, 1, prob_missing)  # Proportion missing: sum(missing_index)/nn #> [1] 0.393 # Replace the values in w by missing in case the index for missingness is =1: w <- ifelse(missing_index==1, NA, w)  # Random effect to include in the regression model: re <- rep(rnorm(nn/20), each = 20)  # Linear predictor eta <-  x + z + re    # Generate Poisson response y <- rpois(nn, exp(eta))  data_pois <- data.frame(x = x, z = z, y = y, w = w, id = rep(seq(1:50), each = 20)) library(lme4) summary(glmer(y ~ x + z + (1|id), data = data_pois, family=\"poisson\"))$coef  summary(glmer(y ~ w + z + (1|id), data = data_pois, family=\"poisson\"))$coef model_pois <- fit_inlamemi(data = data_pois,                        formula_moi = y ~ w + z + f(id,model=\"iid\"),                        formula_imp = w ~ z,                        formula_mis = m ~ z,                        family_moi = \"poisson\",                        error_type = c(\"classical\",\"missing\"),                        prior.prec.classical = c(19, 9),                        prior.prec.imp = c(10, 9),                        prior.beta.error = c(0, 1/1000),                        initial.prec.classical = 2,                        initial.prec.imp = 1)  summary(model_pois) plot(model_pois)"},{"path":"https://emmaskarstein.github.io/inlamemi/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Emma Skarstein. Maintainer, author, copyright holder. Stefanie Muff. Author.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Skarstein ES, Muff S (2023). inlamemi: Missing data imputation measurment error adjustment INLA. R package version 1.0.0, https://github.com/emmaSkarstein/inlamemi.","code":"@Manual{,   title = {inlamemi: Missing data imputation and measurment error adjustment with INLA},   author = {E. S. Skarstein and S. Muff},   year = {2023},   note = {R package version 1.0.0},   url = {https://github.com/emmaSkarstein/inlamemi}, }"},{"path":"https://emmaskarstein.github.io/inlamemi/index.html","id":"inlamemi-","dir":"","previous_headings":"","what":"Missing Data and Measurement Error Modelling in INLA","title":"Missing Data and Measurement Error Modelling in INLA","text":"Fitting measurement error models missing data imputation models INLA trivial, requires several workarounds order fit model. time, Bayesian hierarchical framework attractive modeling types data, since hierarchical model structure allows us describe data collected, errors may , model specification. supplying informative priors, may able adjust biases due errors, propagate uncertainty cause. recently, complicated implement kinds models R-INLA. package provides helpful interface makes measurement error missing data modelling R-INLA much feasible.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Missing Data and Measurement Error Modelling in INLA","text":"can install package directly CRAN : Alternatively, can install development version inlamemi GitHub :","code":"install.packages(\"inlamemi\") # install.packages(\"devtools\") devtools::install_github(\"emmaSkarstein/inlamemi\")"},{"path":"https://emmaskarstein.github.io/inlamemi/index.html","id":"when-should-i-use-this-package","dir":"","previous_headings":"","what":"When should I use this package?","title":"Missing Data and Measurement Error Modelling in INLA","text":"package designed fitting models one covariate classical measurement error, Berkson measurement error, missing observations, combination three. mean missing data, package can missing data imputation. model must class models possible fit R-INLA. means can used common regression types, like linear regression logistic regression, can include many error free covariates needed. can also include random effects, way normally include effects R-INLA. Interaction effects error prone variable also dealt package. even possible fit models cases multiple variables error missingness, though something one careful , models rely heavily priors give .","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/index.html","id":"overview-of-examples","dir":"","previous_headings":"","what":"Overview of examples","title":"Missing Data and Measurement Error Modelling in INLA","text":"Examples use package can found vignettes.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/index.html","id":"quick-guide-how-can-i-use-this-package","dir":"","previous_headings":"","what":"Quick guide: How can I use this package?","title":"Missing Data and Measurement Error Modelling in INLA","text":"dataset simple_data included package, simple simulated data set, used illustrate package. data set, response variable yy, error free covariate zz, covariate observed classical error, Berkson error missingness, called xx. wish fit model y=β0+βxx+βzz+ε,  y = \\beta_0 + \\beta_x x + \\beta_z z + \\varepsilon \\ , adjusting errors xx. First load package: Next, need specify formula main model formula imputation model. done standard way R: imputation model, take advantage correlation xx error free covariate zz, imputation model x=α0+αzz+εx.  x = \\alpha_0 + \\alpha_z z + \\varepsilon_x \\ . write adjusting measurement error, completely dependent information measurement error variances σuc2\\sigma_{u_c}^2 (classical error) σub2\\sigma_{u_b}^2 (Berkson error), since size variance affect estimates biased. can gain information variances different ways, repeated measurements made can put directly model estimate error variance, expert knowledge error size, can used specify informative prior variance (precision, since INLA precision used, rather variance). case, since fact simulated data , know error variances cases close 1, specify priors modes 1. fit_inlamemi function also need specify likelihood model interest, case Gaussian. fit model, can view summary: can use default plot function see plot fixed effects estimated coefficient variable error:","code":"library(inlamemi) main_formula <- y ~ x + z imputation_formula <- x ~ z simple_model <- fit_inlamemi(data = simple_data,                             formula_moi = main_formula,                             formula_imp = imputation_formula,                             family_moi = \"gaussian\",                            error_type = c(\"berkson\", \"classical\", \"missing\"),                            prior.prec.moi = c(10, 9),                            prior.prec.berkson = c(10, 9),                             prior.prec.classical = c(10, 9),                            prior.prec.imp = c(10, 9),                            prior.beta.error = c(0, 1/1000),                            initial.prec.moi = 1,                            initial.prec.berkson = 1,                            initial.prec.classical = 1,                            initial.prec.imp = 1) summary(simple_model) #> Formula for model of interest:  #> y ~ x + z #>  #> Formula for imputation model:  #> x ~ z #>  #> Error types:  #> [1] \"berkson\"   \"classical\" \"missing\"   #>  #> Fixed effects for model of interest:  #>            mean        sd 0.025quant 0.5quant 0.975quant     mode #> beta.0 1.029408 0.2180168  0.6085174 1.028547   1.440033 1.022823 #> beta.z 1.910018 0.3864093  1.2097061 1.899498   2.565503 1.907050 #>  #> Coefficient for variable with measurement error and/or missingness:  #>            mean        sd 0.025quant 0.5quant 0.975quant     mode #> beta.x 1.973031 0.1955614   1.582293  1.97498   2.352271 1.983233 #>  #> Fixed effects for imputation model:  #>               mean         sd 0.025quant 0.5quant 0.975quant     mode #> alpha.x.0 1.033073 0.05060773  0.9337902 1.033081   1.132311 1.033081 #> alpha.x.z 2.024723 0.05227029  1.9222514 2.024706   2.127294 2.024706 #>  #> Model hyperparameters (apart from beta.x):  #>                                      mean        sd 0.025quant  0.5quant #> Precision for model of interest 1.1292120 0.3549186  0.5731591 1.0821470 #> Precision for x berkson model   1.1249792 0.3327340  0.6030345 1.0810229 #> Precision for x classical model 0.9248817 0.1063716  0.7351107 0.9181755 #> Precision for x imp model       0.9778644 0.1225878  0.7574632 0.9707262 #>                                 0.975quant      mode #> Precision for model of interest   1.955436 0.9960169 #> Precision for x berkson model     1.900730 0.9994948 #> Precision for x classical model   1.153382 0.9036513 #> Precision for x imp model         1.239320 0.9574767 plot(simple_model)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/coef.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract model coefficients — coef.inlamemi","title":"Extract model coefficients — coef.inlamemi","text":"Extract model coefficients","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/coef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract model coefficients — coef.inlamemi","text":"","code":"# S3 method for class 'inlamemi' coef(object, ...)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/coef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract model coefficients — coef.inlamemi","text":"object object class `inlamemi` ... arguments","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/extract_random_effects.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract random effects from formula — extract_random_effects","title":"Extract random effects from formula — extract_random_effects","text":"Extract random effects formula","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/extract_random_effects.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract random effects from formula — extract_random_effects","text":"","code":"extract_random_effects(formula)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/extract_random_effects.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract random effects from formula — extract_random_effects","text":"formula object class \"formula\", either formula model interest, imputation model missingness model.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/extract_random_effects.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract random effects from formula — extract_random_effects","text":"list containing \"reff_vars\", random effect variables, \"reff\", entire random effect term.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/extract_variables_from_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract and group variables from formulas — extract_variables_from_formula","title":"Extract and group variables from formulas — extract_variables_from_formula","text":"Helper function takes formulas model interest imputation model, groups responses, covariates, covariate error covariate(s) without error, sub-models.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/extract_variables_from_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract and group variables from formulas — extract_variables_from_formula","text":"","code":"extract_variables_from_formula(   formula_moi,   formula_imp,   formula_mis = NULL,   error_variable = NULL )"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/extract_variables_from_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract and group variables from formulas — extract_variables_from_formula","text":"formula_moi object class \"formula\", describing main model fitted. formula_imp object class \"formula\", describing imputation model mismeasured /missing observations. formula_mis object class \"formula\", describing missingness model. need response variable, since always binary missingness indicator. error_variable character vector name(s) variable(s) error.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/extract_variables_from_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract and group variables from formulas — extract_variables_from_formula","text":"list containing names different variables model. names elements list \"response_moi\" (response moi), \"covariates_moi\" (covariates moi), \"error_variable\" (name variable error missing data), \"covariates_error_free\" (moi covariates without error), \"response_imp\" (imputation model response), \"covariates_imp\" (imputation model covariates).","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/fit_inlamemi.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit model for measurement error and missing data in INLA — fit_inlamemi","title":"Fit model for measurement error and missing data in INLA — fit_inlamemi","text":"wrapper function around \"INLA::inla()\", providing necessary structure fit hierarchical measurement error model adjusts coefficient estimates account biases due measurement error missing data.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/fit_inlamemi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit model for measurement error and missing data in INLA — fit_inlamemi","text":"","code":"fit_inlamemi(   formula_moi,   formula_imp = NULL,   formula_mis = NULL,   family_moi,   data,   error_type = \"classical\",   error_variable = NULL,   repeated_observations = FALSE,   classical_error_scaling = NULL,   prior.prec.moi = NULL,   prior.prec.berkson = NULL,   prior.prec.classical = NULL,   prior.prec.imp = NULL,   prior.beta.error = NULL,   prior.gamma.error = NULL,   initial.prec.moi = NULL,   initial.prec.berkson = NULL,   initial.prec.classical = NULL,   initial.prec.imp = NULL,   control.family.moi = NULL,   control.family.berkson = NULL,   control.family.classical = NULL,   control.family.imp = NULL,   control.family = NULL,   control.predictor = NULL,   ... )"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/fit_inlamemi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit model for measurement error and missing data in INLA — fit_inlamemi","text":"formula_moi object class \"formula\", describing main model fitted. formula_imp object class \"formula\", describing imputation model mismeasured /missing observations. formula_mis object class \"formula\", describing missingness model. need response variable, since always binary missingness indicator. family_moi string indicating likelihood family model interest (main model). data object class data.frame list containing variables model. error_type type error (one \"classical\", \"berkson\", \"missing\") error_variable character vector name(s) variable(s) error. repeated_observations variable measurement error /missingness repeated observations? , set \"TRUE\". case, specifying formula, use name variable without numbers, specifying data, make sure repeated measurements end number, .e \"sbp1\" \"sbp2\". classical_error_scaling can specified classical measurement error varies across observations. Must vector length data. prior.prec.moi string containing parameters prior precision residual term model interest. prior.prec.berkson string containing parameters prior precision error term Berkson error model. prior.prec.classical string containing parameters prior precision error term classical error model. prior.prec.imp string containing parameters precision latent variable x, variable described imputation model. prior.beta.error parameters Gaussian prior coefficient error prone variable. prior.gamma.error parameters Gaussian prior coefficient variable missingness missingness model. initial.prec.moi initial value precision residual term model interest. initial.prec.berkson initial value precision residual term Berkson error term. initial.prec.classical initial value precision residual term classical error term. initial.prec.imp initial value precision residual term latent variable r. control.family.moi control.family component model interest. Can specified using inla syntax instead passing \"prior.prec...\" \"initial.prec...\" arguments, cases hyperparameters needed model interest, see instance survival models. control.family.berkson control.family component Berkson model. Can specified using inla syntax instead passing \"prior.prec...\" \"initial.prec...\" arguments. Useful cases flexibility needed, instance one wants specify different prior distribution Gamma. control.family.classical control.family component classical model. Can specified using inla syntax instead passing \"prior.prec...\" \"initial.prec...\" arguments. Useful cases flexibility needed, instance one wants specify different prior distribution Gamma. control.family.imp control.family component imputation model. Can specified using inla syntax instead passing \"prior.prec...\" \"initial.prec...\" arguments. Useful cases flexibility needed, instance one wants specify different prior distribution Gamma. control.family control.family use inla (can provided directly instead passing \"prior.prec....\" \"initial.prec...\" arguments. specified, \"control.family...\" \"prior.prec...\" arguments provided ignored. control.predictor control.predictor use inla. ... arguments pass `inla`.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/fit_inlamemi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit model for measurement error and missing data in INLA — fit_inlamemi","text":"object class inlamemi.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/fit_inlamemi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit model for measurement error and missing data in INLA — fit_inlamemi","text":"","code":"# Fit the model simple_model <- fit_inlamemi(data = simple_data,                            formula_moi = y ~ x + z,                            formula_imp = x ~ z,                            family_moi = \"gaussian\",                            error_type = c(\"berkson\", \"classical\"),                            error_variable = \"x\",                            prior.prec.moi = c(10, 9),                            prior.prec.berkson = c(10, 9),                            prior.prec.classical = c(10, 9),                            prior.prec.imp = c(10, 9),                            prior.beta.error = c(0, 1/1000),                            initial.prec.moi = 1,                            initial.prec.berkson = 1,                            initial.prec.classical = 1,                            initial.prec.imp = 1)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/framingham.html","id":null,"dir":"Reference","previous_headings":"","what":"Framingham heart study data — framingham","title":"Framingham heart study data — framingham","text":"data set observations heart disease status systolic blood pressure (SBP) smoking status.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/framingham.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Framingham heart study data — framingham","text":"","code":"framingham"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/framingham.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Framingham heart study data — framingham","text":"## `framingham` data frame 641 rows 4 columns: disease binary response, 1 heart disease, 0 otherwise sbp1 log(SBP - 50) examination 1 (centered) sbp2 log(SBP - 50) examination 2 (centered) smoking Smoking status, 1 smoking, 0 otherwise.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/framingham.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Framingham heart study data — framingham","text":"MacMahon et al. (1990) <https://doi.org/10.1016/0140-6736(90)90878-9>","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_coef_imp.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract coefficients for the imputation model (IMP) — get_coef_imp","title":"Extract coefficients for the imputation model (IMP) — get_coef_imp","text":"Extract coefficients imputation model (IMP)","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_coef_imp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract coefficients for the imputation model (IMP) — get_coef_imp","text":"","code":"get_coef_imp(inlamemi_model)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_coef_imp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract coefficients for the imputation model (IMP) — get_coef_imp","text":"inlamemi_model object class `inlamemi`","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_coef_imp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract coefficients for the imputation model (IMP) — get_coef_imp","text":"data frame summary posterior marginals coefficients imputation model.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_coef_mis.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract coefficients for the missingness model (MIS) — get_coef_mis","title":"Extract coefficients for the missingness model (MIS) — get_coef_mis","text":"Extract coefficients missingness model (MIS)","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_coef_mis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract coefficients for the missingness model (MIS) — get_coef_mis","text":"","code":"get_coef_mis(inlamemi_model)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_coef_mis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract coefficients for the missingness model (MIS) — get_coef_mis","text":"inlamemi_model object class `inlamemi`","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_coef_mis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract coefficients for the missingness model (MIS) — get_coef_mis","text":"data frame summary posterior marginals coefficients missingness model.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_coef_moi.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract coefficients for the model of interest (MOI) — get_coef_moi","title":"Extract coefficients for the model of interest (MOI) — get_coef_moi","text":"Extract coefficients model interest (MOI)","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_coef_moi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract coefficients for the model of interest (MOI) — get_coef_moi","text":"","code":"get_coef_moi(inlamemi_model)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_coef_moi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract coefficients for the model of interest (MOI) — get_coef_moi","text":"inlamemi_model object class `inlamemi`","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_coef_moi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract coefficients for the model of interest (MOI) — get_coef_moi","text":"data frame summary posterior marginals coefficients model interest.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_imputed.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract imputed values — get_imputed","title":"Extract imputed values — get_imputed","text":"Extract imputed values","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_imputed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract imputed values — get_imputed","text":"","code":"get_imputed(inlamemi_model, error_variable)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_imputed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract imputed values — get_imputed","text":"inlamemi_model object class `inlamemi` error_variable character string indicating name error variable extract imputed values.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/get_imputed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract imputed values — get_imputed","text":"list two objects: posterior marginal distributions element imputed covariate, data frame giving summary marginals.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/inla_survival_families.html","id":null,"dir":"Reference","previous_headings":"","what":"List the survival likelihoods in INLA — inla_survival_families","title":"List the survival likelihoods in INLA — inla_survival_families","text":"List survival likelihoods INLA","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/inla_survival_families.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List the survival likelihoods in INLA — inla_survival_families","text":"","code":"inla_survival_families()"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/inla_survival_families.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List the survival likelihoods in INLA — inla_survival_families","text":"List survival models INLA","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_control.family.html","id":null,"dir":"Reference","previous_headings":"","what":"Make ","title":"Make ","text":"Make \"control.family\" argument passing \"inla\" function","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_control.family.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make ","text":"","code":"make_inlamemi_control.family(   formula_mis = NULL,   family_moi,   error_type = \"classical\",   prior.prec.moi = NULL,   prior.prec.berkson = NULL,   prior.prec.classical = NULL,   prior.prec.imp = NULL,   initial.prec.moi = NULL,   initial.prec.berkson = NULL,   initial.prec.classical = NULL,   initial.prec.imp = NULL,   control.family.moi = NULL,   control.family.berkson = NULL,   control.family.classical = NULL,   control.family.imp = NULL,   control.family = NULL )"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_control.family.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make ","text":"formula_mis object class \"formula\", describing missingness model. need response variable, since always binary missingness indicator. family_moi string indicating likelihood family model interest (main model). error_type type error (one \"classical\", \"berkson\", \"missing\") prior.prec.moi string containing parameters prior precision residual term model interest. prior.prec.berkson string containing parameters prior precision error term Berkson error model. prior.prec.classical string containing parameters prior precision error term classical error model. prior.prec.imp string containing parameters precision latent variable x, variable described imputation model. initial.prec.moi initial value precision residual term model interest. initial.prec.berkson initial value precision residual term Berkson error term. initial.prec.classical initial value precision residual term classical error term. initial.prec.imp initial value precision residual term latent variable r. control.family.moi control.family component model interest. Can specified using inla syntax instead passing \"prior.prec...\" \"initial.prec...\" arguments, cases hyperparameters needed model interest, see instance survival models. control.family.berkson control.family component Berkson model. Can specified using inla syntax instead passing \"prior.prec...\" \"initial.prec...\" arguments. Useful cases flexibility needed, instance one wants specify different prior distribution Gamma. control.family.classical control.family component classical model. Can specified using inla syntax instead passing \"prior.prec...\" \"initial.prec...\" arguments. Useful cases flexibility needed, instance one wants specify different prior distribution Gamma. control.family.imp control.family component imputation model. Can specified using inla syntax instead passing \"prior.prec...\" \"initial.prec...\" arguments. Useful cases flexibility needed, instance one wants specify different prior distribution Gamma. control.family control.family use inla (can provided directly instead passing \"prior.prec....\" \"initial.prec...\" arguments. specified, \"control.family...\" \"prior.prec...\" arguments provided ignored.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_control.family.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make ","text":"\"control.family\" argument passed inla, list \"control.family\" arguments model hierarchical measurement error model.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_control.family.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make ","text":"","code":"make_inlamemi_control.family(   family_moi = \"gaussian\",   error_type = c(\"berkson\", \"classical\"),   prior.prec.moi = c(10, 9),   prior.prec.berkson = c(10, 9),   prior.prec.classical = c(10, 9),   prior.prec.imp = c(10, 9),   initial.prec.moi = 1,   initial.prec.berkson = 1,   initial.prec.classical = 1,   initial.prec.imp = 1) #> [[1]] #> [[1]]$hyper #> [[1]]$hyper$prec #> [[1]]$hyper$prec$initial #> [1] 0 #>  #> [[1]]$hyper$prec$param #> [1] 10  9 #>  #> [[1]]$hyper$prec$fixed #> [1] FALSE #>  #>  #>  #>  #> [[2]] #> [[2]]$hyper #> [[2]]$hyper$prec #> [[2]]$hyper$prec$initial #> [1] 0 #>  #> [[2]]$hyper$prec$param #> [1] 10  9 #>  #> [[2]]$hyper$prec$fixed #> [1] FALSE #>  #>  #>  #>  #> [[3]] #> [[3]]$hyper #> [[3]]$hyper$prec #> [[3]]$hyper$prec$initial #> [1] 0 #>  #> [[3]]$hyper$prec$param #> [1] 10  9 #>  #> [[3]]$hyper$prec$fixed #> [1] FALSE #>  #>  #>  #>  #> [[4]] #> [[4]]$hyper #> [[4]]$hyper$prec #> [[4]]$hyper$prec$initial #> [1] 0 #>  #> [[4]]$hyper$prec$param #> [1] 10  9 #>  #> [[4]]$hyper$prec$fixed #> [1] FALSE #>  #>  #>  #>   make_inlamemi_control.family(   family_moi = \"weibull.surv\",   error_type = c(\"classical\", \"missing\"),   control.family.moi =     list(hyper = list(alpha = list(param = 0.01,                                    initial = log(1.4),                                    fixed = FALSE))),   prior.prec.classical = c(0.5, 0.5),   prior.prec.imp = c(0.5, 0.5),   initial.prec.classical = 2.8,   initial.prec.imp = 1) #> [[1]] #> [[1]]$hyper #> [[1]]$hyper$alpha #> [[1]]$hyper$alpha$param #> [1] 0.01 #>  #> [[1]]$hyper$alpha$initial #> [1] 0.3364722 #>  #> [[1]]$hyper$alpha$fixed #> [1] FALSE #>  #>  #>  #>  #> [[2]] #> [[2]]$hyper #> [[2]]$hyper$prec #> [[2]]$hyper$prec$initial #> [1] 1.029619 #>  #> [[2]]$hyper$prec$param #> [1] 0.5 0.5 #>  #> [[2]]$hyper$prec$fixed #> [1] FALSE #>  #>  #>  #>  #> [[3]] #> [[3]]$hyper #> [[3]]$hyper$prec #> [[3]]$hyper$prec$initial #> [1] 0 #>  #> [[3]]$hyper$prec$param #> [1] 0.5 0.5 #>  #> [[3]]$hyper$prec$fixed #> [1] FALSE #>  #>  #>  #>"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_families.html","id":null,"dir":"Reference","previous_headings":"","what":"Make vector of likelihood families — make_inlamemi_families","title":"Make vector of likelihood families — make_inlamemi_families","text":"Make vector likelihood families","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_families.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make vector of likelihood families — make_inlamemi_families","text":"","code":"make_inlamemi_families(family_moi, inlamemi_stack)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_families.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make vector of likelihood families — make_inlamemi_families","text":"family_moi string indicating likelihood family model interest (main model). inlamemi_stack object type inla.stack","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_families.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make vector of likelihood families — make_inlamemi_families","text":"vector specifying likelihood family model level.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_families.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make vector of likelihood families — make_inlamemi_families","text":"","code":"simple_stack <- make_inlamemi_stacks(formula_moi = y ~ x + z,                                      formula_imp = x ~ z,                                      data = simple_data,                                      error_type = c(\"classical\")) make_inlamemi_families(family_moi = \"gaussian\",                        inlamemi_stack = simple_stack) #> [1] \"gaussian\" \"gaussian\" \"gaussian\""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Make formula for measurement error and missing data model — make_inlamemi_formula","title":"Make formula for measurement error and missing data model — make_inlamemi_formula","text":"Make formula measurement error missing data model","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make formula for measurement error and missing data model — make_inlamemi_formula","text":"","code":"make_inlamemi_formula(   formula_moi,   formula_imp,   formula_mis = NULL,   family_moi = \"gaussian\",   error_type = \"classical\",   error_variable = NULL,   prior.beta.error,   prior.gamma.error = NULL,   vars = NULL )"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make formula for measurement error and missing data model — make_inlamemi_formula","text":"formula_moi object class \"formula\", describing main model fitted. formula_imp object class \"formula\", describing imputation model mismeasured /missing observations. formula_mis object class \"formula\", describing missingness model. need response variable, since always binary missingness indicator. family_moi string indicating likelihood family model interest (main model). error_type type error (one \"classical\", \"berkson\", \"missing\") error_variable character vector name(s) variable(s) error. prior.beta.error parameters Gaussian prior coefficient error prone variable. prior.gamma.error parameters Gaussian prior coefficient variable missingness missingness model. vars Results call \"extract_variables_from_formula\" function. passed argument, called inside function.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make formula for measurement error and missing data model — make_inlamemi_formula","text":"object class \"formula\".","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_formula.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make formula for measurement error and missing data model — make_inlamemi_formula","text":"","code":"make_inlamemi_formula(formula_moi = y ~ x + z,                       formula_imp = x ~ z,                       error_type = \"classical\",                       prior.beta.error = c(0, 1/1000)                       ) #> list(y_moi, x_classical, x_imp) ~ -1 + beta.0 + beta.z + alpha.x.0 +  #>     alpha.x.z + f(beta.x, copy = \"id.x\", hyper = list(beta = list(param = c(0,  #>     0.001), fixed = FALSE))) + f(id.x, weight.x, model = \"iid\",  #>     values = 1:n, hyper = list(prec = list(initial = -15, fixed = TRUE))) #> <environment: 0x55d223524370>"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_scaling_vector.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct scaling vector to scale the precision of correctly observed observations — make_inlamemi_scaling_vector","title":"Construct scaling vector to scale the precision of correctly observed observations — make_inlamemi_scaling_vector","text":"Construct scaling vector scale precision correctly observed observations","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_scaling_vector.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct scaling vector to scale the precision of correctly observed observations — make_inlamemi_scaling_vector","text":"","code":"make_inlamemi_scaling_vector(   inlamemi_stack,   error_type,   classical_error_scaling = NULL,   vars )"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_scaling_vector.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct scaling vector to scale the precision of correctly observed observations — make_inlamemi_scaling_vector","text":"inlamemi_stack object class inlamemi.data.stack containing data structured error_type type error (one \"classical\", \"berkson\", \"missing\") classical_error_scaling can specified classical measurement error varies across observations. Must vector length data. vars Results call \"extract_variables_from_formula\" function. passed argument, called inside function.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_scaling_vector.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct scaling vector to scale the precision of correctly observed observations — make_inlamemi_scaling_vector","text":"vector reflecting scaling factor residual terms model level.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_scaling_vector.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct scaling vector to scale the precision of correctly observed observations — make_inlamemi_scaling_vector","text":"","code":"stacks <- make_inlamemi_stacks(data = simple_data,                              formula_moi = y ~ x + z,                              formula_imp = x ~ z,                              error_type = c(\"classical\", \"berkson\")) vars <- extract_variables_from_formula(formula_moi = y ~ x + z,                                        formula_imp = x ~ z) make_inlamemi_scaling_vector(stacks,                            error_type = c(\"classical\", \"berkson\"),                            vars = vars) #>    [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>   [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>   [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [112] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [149] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [186] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [223] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [260] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [297] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [334] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [371] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [408] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [445] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [482] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [519] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [556] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [593] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [630] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [667] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [704] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [741] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [778] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [815] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [852] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [889] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [926] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [963] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1000] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1037] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1074] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1111] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1148] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1185] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1222] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1259] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1296] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1333] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1370] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1407] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1444] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1481] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1518] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1555] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1592] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1629] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1666] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1703] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1740] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1777] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1814] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1851] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1888] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1925] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1962] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [1999] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2036] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2073] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2110] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2147] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2184] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2221] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2258] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2295] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2332] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2369] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2406] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2443] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2480] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2517] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2554] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2591] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2628] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2665] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2702] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2739] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2776] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2813] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2850] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2887] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2924] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2961] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [2998] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3035] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3072] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3109] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3146] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3183] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3220] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3257] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3294] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3331] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3368] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3405] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3442] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3479] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3516] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3553] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3590] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3627] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3664] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3701] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3738] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3775] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3812] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3849] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3886] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3923] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3960] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [3997] 1 1 1 1"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_stacks.html","id":null,"dir":"Reference","previous_headings":"","what":"Make data stacks for joint model specification in INLA — make_inlamemi_stacks","title":"Make data stacks for joint model specification in INLA — make_inlamemi_stacks","text":"Make data stacks joint model specification INLA","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_stacks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make data stacks for joint model specification in INLA — make_inlamemi_stacks","text":"","code":"make_inlamemi_stacks(   formula_moi,   formula_imp,   formula_mis = NULL,   family_moi = \"gaussian\",   data,   error_type = \"classical\",   error_variable = NULL,   repeated_observations = FALSE,   vars = NULL )"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_stacks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make data stacks for joint model specification in INLA — make_inlamemi_stacks","text":"formula_moi object class \"formula\", describing main model fitted. formula_imp object class \"formula\", describing imputation model mismeasured /missing observations. formula_mis object class \"formula\", describing missingness model. need response variable, since always binary missingness indicator. family_moi string indicating likelihood family model interest (main model). data object class data.frame list containing variables model. error_type type error (one \"classical\", \"berkson\", \"missing\") error_variable character vector name(s) variable(s) error. repeated_observations variable measurement error /missingness repeated observations? , set \"TRUE\". case, specifying formula, use name variable without numbers, specifying data, make sure repeated measurements end number, .e \"sbp1\" \"sbp2\". vars Results call \"extract_variables_from_formula\" function. passed argument, called inside function.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_stacks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make data stacks for joint model specification in INLA — make_inlamemi_stacks","text":"object class inla.stack data structured according specified formulas error models.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/make_inlamemi_stacks.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make data stacks for joint model specification in INLA — make_inlamemi_stacks","text":"","code":"make_inlamemi_stacks(formula_moi = y ~ x + z,                    formula_imp = x ~ z,                    data = simple_data,                    error_type = \"classical\") #> Data stack with #>   data:    (y_moi, x_classical, x_imp), size: 3000 #>   effects: (beta.0, beta.x, beta.z, id.x, weight.x, alpha.x.0, alpha.x.z), size: 3000 #>   A:       3000 times 3000 #>   response: 1 response objects"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/mar_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated data with observation missing at random (MAR) — mar_data","title":"Simulated data with observation missing at random (MAR) — mar_data","text":"simulated dataset demonstrate set model case two variables measurement error.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/mar_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated data with observation missing at random (MAR) — mar_data","text":"","code":"mar_data"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/mar_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated data with observation missing at random (MAR) — mar_data","text":"## `mar_data` data frame 1000 rows 5 columns: y Response variable x Observed value covariate, almost 20 percent missing x_true Correct version x, without missingness z1 Covariate correlated x z2 Covariate correlated missingness x","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/mar_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Simulated data with observation missing at random (MAR) — mar_data","text":"dataset simulated.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/nhanes_survival.html","id":null,"dir":"Reference","previous_headings":"","what":"Survival data with repeated systolic blood pressure measurements — nhanes_survival","title":"Survival data with repeated systolic blood pressure measurements — nhanes_survival","text":"dataset containing repeated blood pressure measurement along variables participants Third National Health Nutrition Survey (NHANES III), merged data US National Death Index Ruth H. Keogh Jonathan Bartlett. illustration purposes package, left observations smoking status missing.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/nhanes_survival.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Survival data with repeated systolic blood pressure measurements — nhanes_survival","text":"","code":"nhanes_survival"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/nhanes_survival.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Survival data with repeated systolic blood pressure measurements — nhanes_survival","text":"## `nhanes_survival` data frame 3433 rows 8 columns: sbp1 systolic blood pressure (standardized), first measurement sbp2 systolic blood pressure (standardized), second measurement sex sex (0 = female, 1 = male) age age (standardized) smoke smoking status (0 = , 1 = yes) diabetes diabetes status (0 = , 1 = yes) d censoring status (0 = censored, 1 = observed death due cardiovascular disease) t time death due cardiovascular disease occurs","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/nhanes_survival.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Survival data with repeated systolic blood pressure measurements — nhanes_survival","text":"https://github.com/ruthkeogh/meas_error_handbook","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/plot.inlamemi.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot model summary — plot.inlamemi","title":"Plot model summary — plot.inlamemi","text":"Plot model summary","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/plot.inlamemi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot model summary — plot.inlamemi","text":"","code":"# S3 method for class 'inlamemi' plot(   x,   plot_moi = TRUE,   plot_imp = TRUE,   plot_mis = TRUE,   plot_intercepts = TRUE,   error_variable_highlight = FALSE,   greek = FALSE,   palette = NULL,   ... )"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/plot.inlamemi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot model summary — plot.inlamemi","text":"x model returned fit_inlamemi function. plot_moi posterior mean coefficients model interest plotted? Defaults TRUE. plot_imp posterior mean coefficients imputation model plotted? Defaults TRUE. plot_mis posterior mean coefficients missingness model plotted? Defaults TRUE. plot_intercepts posterior mean intercept(s) plotted? Defaults TRUE. error_variable_highlight coefficient(s) variable(s) error highlighted? (circled black) Defaults FALSE. greek make coefficient names greek letters covariate name subscript. Defaults FALSE. palette either number (1 5), indicating number color palette used, vector colors used. ... arguments","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/plot.inlamemi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot model summary — plot.inlamemi","text":"object class \"ggplot2\" plots posterior mean 95 % credible interval coefficient model. coefficients colored indicate belong main imputation model, variable error also highlighted.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/plot.inlamemi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot model summary — plot.inlamemi","text":"","code":"# Fit the model simple_model <- fit_inlamemi(data = simple_data,                            formula_moi = y ~ x + z,                            formula_imp = x ~ z,                            family_moi = \"gaussian\",                            error_type = c(\"berkson\", \"classical\"),                            prior.prec.moi = c(10, 9),                            prior.prec.berkson = c(10, 9),                            prior.prec.classical = c(10, 9),                            prior.prec.imp = c(10, 9),                            prior.beta.error = c(0, 1/1000),                            initial.prec.moi = 1,                            initial.prec.berkson = 1,                            initial.prec.classical = 1,                            initial.prec.imp = 1)  plot(simple_model)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/print.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for inlamemi — print.inlamemi","title":"Print method for inlamemi — print.inlamemi","text":"Print method inlamemi","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/print.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for inlamemi — print.inlamemi","text":"","code":"# S3 method for class 'inlamemi' print(x, ...)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/print.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for inlamemi — print.inlamemi","text":"x object class `inlamemi`. ... arguments.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/show_data_structure.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize the model data structure as matrices in LaTeX — show_data_structure","title":"Visualize the model data structure as matrices in LaTeX — show_data_structure","text":"Visualize model data structure matrices LaTeX","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/show_data_structure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize the model data structure as matrices in LaTeX — show_data_structure","text":"","code":"show_data_structure(stack)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/show_data_structure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize the model data structure as matrices in LaTeX — show_data_structure","text":"stack object class inla.stack returned function make_inlamemi_stacks, describes structure data measurement error imputation model.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/show_data_structure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize the model data structure as matrices in LaTeX — show_data_structure","text":"list containing data frames left hand side (response_df) right hand side (effects_df), along latex code needed visualize matrices (matrix_string).","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/show_data_structure.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize the model data structure as matrices in LaTeX — show_data_structure","text":"","code":"stack <- make_inlamemi_stacks(data = simple_data,                    formula_moi = y ~ x + z,                    formula_imp = x ~ z,                    error_type = \"classical\") show_data_structure(stack) #> $response_df #>        y_moi x_classical   x_imp #> 1      10.81        <NA>    <NA> #> 2    \\\\vdots     \\\\vdots \\\\vdots #> 1000    6.18        <NA>    <NA> #> 1001    <NA>        4.98    <NA> #> 5    \\\\vdots     \\\\vdots \\\\vdots #> 2000    <NA>        1.46    <NA> #> 2001    <NA>        <NA>       0 #> 8    \\\\vdots     \\\\vdots \\\\vdots #> 3000    <NA>        <NA>       0 #>  #> $effects_df #>       beta.0  beta.x  beta.z    id.x weight.x alpha.x.0 alpha.x.z #> 1          1       1    0.98    <NA>     <NA>      <NA>      <NA> #> 2    \\\\vdots \\\\vdots \\\\vdots \\\\vdots  \\\\vdots   \\\\vdots   \\\\vdots #> 1000       1    1000    0.77    <NA>     <NA>      <NA>      <NA> #> 1001    <NA>    <NA>    <NA>       1        1      <NA>      <NA> #> 5    \\\\vdots \\\\vdots \\\\vdots \\\\vdots  \\\\vdots   \\\\vdots   \\\\vdots #> 2000    <NA>    <NA>    <NA>    1000        1      <NA>      <NA> #> 2001    <NA>    <NA>    <NA>      -1       -1         1      0.98 #> 8    \\\\vdots \\\\vdots \\\\vdots \\\\vdots  \\\\vdots   \\\\vdots   \\\\vdots #> 3000    <NA>    <NA>    <NA>   -1000       -1         1      0.77 #>  #> $matrix_string #> [1] \"$$\\\\underbrace{\\\\begin{bmatrix} \\n10.81 & \\\\texttt{NA} & \\\\texttt{NA}\\\\\\\\\\n\\\\vdots & \\\\vdots & \\\\vdots\\\\\\\\\\n6.18 & \\\\texttt{NA} & \\\\texttt{NA}\\\\\\\\\\n\\\\texttt{NA} & 4.98 & \\\\texttt{NA}\\\\\\\\\\n\\\\vdots & \\\\vdots & \\\\vdots\\\\\\\\\\n\\\\texttt{NA} & 1.46 & \\\\texttt{NA}\\\\\\\\\\n\\\\texttt{NA} & \\\\texttt{NA} & 0\\\\\\\\\\n\\\\vdots & \\\\vdots & \\\\vdots\\\\\\\\\\n\\\\texttt{NA} & \\\\texttt{NA} & 0\\\\\\\\\\n\\\\end{bmatrix}}_{\\\\texttt{Y}}\\n = \\n\\\\beta_{0}\\\\underbrace{\\\\begin{bmatrix} \\n1\\\\\\\\\\n\\\\vdots\\\\\\\\\\n1\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\vdots\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\vdots\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\end{bmatrix}}_{\\\\texttt{beta.0}} + \\\\beta_{x}\\\\underbrace{\\\\begin{bmatrix} \\n1\\\\\\\\\\n\\\\vdots\\\\\\\\\\n1000\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\vdots\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\vdots\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\end{bmatrix}}_{\\\\texttt{beta.x}} + \\\\beta_{z}\\\\underbrace{\\\\begin{bmatrix} \\n0.98\\\\\\\\\\n\\\\vdots\\\\\\\\\\n0.77\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\vdots\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\vdots\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\end{bmatrix}}_{\\\\texttt{beta.z}} + \\\\underbrace{\\\\begin{bmatrix} \\n\\\\texttt{NA}\\\\\\\\\\n\\\\vdots\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n1\\\\\\\\\\n\\\\vdots\\\\\\\\\\n1000\\\\\\\\\\n-1\\\\\\\\\\n\\\\vdots\\\\\\\\\\n-1000\\\\\\\\\\n\\\\end{bmatrix}}_{\\\\texttt{id.x}} + \\\\alpha_{x,0}\\\\underbrace{\\\\begin{bmatrix} \\n\\\\texttt{NA}\\\\\\\\\\n\\\\vdots\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\vdots\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n1\\\\\\\\\\n\\\\vdots\\\\\\\\\\n1\\\\\\\\\\n\\\\end{bmatrix}}_{\\\\texttt{alpha.x.0}} + \\\\alpha_{x,z}\\\\underbrace{\\\\begin{bmatrix} \\n\\\\texttt{NA}\\\\\\\\\\n\\\\vdots\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n\\\\vdots\\\\\\\\\\n\\\\texttt{NA}\\\\\\\\\\n0.98\\\\\\\\\\n\\\\vdots\\\\\\\\\\n0.77\\\\\\\\\\n\\\\end{bmatrix}}_{\\\\texttt{alpha.x.z}}$$\" #>"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/simple_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple simulated data — simple_data","title":"Simple simulated data — simple_data","text":"simulated dataset demonstrate model different types measurement error missing data using 'inlamemi' package.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/simple_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple simulated data — simple_data","text":"","code":"simple_data"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/simple_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simple simulated data — simple_data","text":"## `simple_data` data frame 1000 rows 4 columns: y Response variable x Covariate measured error, Berkson classical error missing observations x_true Correct version covariate error z Error free covariate, correlated x","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/simple_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Simple simulated data — simple_data","text":"dataset simulated.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/simplify_inlamemi_model_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Simplify the ","title":"Simplify the ","text":"Simplify \"raw\" model summary printing plotting","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/simplify_inlamemi_model_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simplify the ","text":"","code":"simplify_inlamemi_model_summary(inlamemi_model)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/simplify_inlamemi_model_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simplify the ","text":"inlamemi_model model returned fit_inlamemi function.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/simplify_inlamemi_model_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simplify the ","text":"list four data frames, containing summaries different components model. coefficients model interest, coefficient variable error, coefficients imputation model, hyperparameters.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for inlamemi — summary.inlamemi","title":"Summary method for inlamemi — summary.inlamemi","text":"Takes fitted `inlamemi` object produced `fit_inlamemi` produces summary .","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for inlamemi — summary.inlamemi","text":"","code":"# S3 method for class 'inlamemi' summary(object, ...)  # S3 method for class 'summary.inlamemi' print(x, ...)"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for inlamemi — summary.inlamemi","text":"object model class `inlamemi`. ... arguments x object class summary.inlamemi.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary method for inlamemi — summary.inlamemi","text":"`summary.inlamemi` returns object class `summary.inlamemi`, list components print.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/summary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary method for inlamemi — summary.inlamemi","text":"","code":"# Fit the model simple_model <- fit_inlamemi(data = simple_data,                            formula_moi = y ~ x + z,                            formula_imp = x ~ z,                            family_moi = \"gaussian\",                            error_type = c(\"berkson\", \"classical\"),                            prior.prec.moi = c(10, 9),                            prior.prec.berkson = c(10, 9),                            prior.prec.classical = c(10, 9),                            prior.prec.imp = c(10, 9),                            prior.beta.error = c(0, 1/1000),                            initial.prec.moi = 1,                            initial.prec.berkson = 1,                            initial.prec.classical = 1,                            initial.prec.imp = 1)  summary(simple_model) #> Formula for model of interest:  #> y ~ x + z #>  #> Formula for imputation model:  #> x ~ z #>  #> Error types:  #> [1] \"berkson\"   \"classical\" #>  #> Fixed effects for model of interest:  #>            mean        sd 0.025quant 0.5quant 0.975quant     mode #> beta.0 1.033885 0.2182911  0.6118263 1.034314   1.445395 1.028072 #> beta.z 1.919817 0.3871734  1.2196917 1.910930   2.583442 1.915278 #>  #> Coefficient for variable with measurement error and/or missingness:  #>            mean        sd 0.025quant 0.5quant 0.975quant     mode #> beta.x 1.974594 0.1954074   1.587021 1.975579   2.356408 1.979692 #>  #> Fixed effects for imputation model:  #>               mean         sd 0.025quant 0.5quant 0.975quant     mode #> alpha.x.0 1.033074 0.05060181  0.9338043 1.033082   1.132301 1.033082 #> alpha.x.z 2.024720 0.05226362  1.9222595 2.024704   2.127275 2.024704 #>  #> Model hyperparameters (apart from beta.x):  #>                                      mean        sd 0.025quant  0.5quant #> Precision for model of interest 1.1293529 0.3537397  0.5732360 1.0830362 #> Precision for x berkson model   1.1239105 0.3317552  0.6078515 1.0786884 #> Precision for x classical model 0.9257665 0.1069530  0.7336495 0.9194670 #> Precision for x imp model       0.9770666 0.1230084  0.7572519 0.9694457 #>                                 0.975quant      mode #> Precision for model of interest   1.950959 0.9985215 #> Precision for x berkson model     1.901843 0.9940753 #> Precision for x classical model   1.154183 0.9066419 #> Precision for x imp model         1.240776 0.9544314 #>"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/two_error_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated data with two covariates with classical measurement error — two_error_data","title":"Simulated data with two covariates with classical measurement error — two_error_data","text":"simulated dataset demonstrate set model case two variables measurement error.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/two_error_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated data with two covariates with classical measurement error — two_error_data","text":"","code":"two_error_data"},{"path":"https://emmaskarstein.github.io/inlamemi/reference/two_error_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated data with two covariates with classical measurement error — two_error_data","text":"## `two_error_data` data frame 1000 rows 5 columns: y Response variable x1 Covariate measured classical error, correlated z x2 Covariate measured classical error x1_true Correct version x1 x2_true Correct version x2 z Error free covariate, correlated x1","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/reference/two_error_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Simulated data with two covariates with classical measurement error — two_error_data","text":"dataset simulated.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/news/index.html","id":"inlamemi-110","dir":"Changelog","previous_headings":"","what":"inlamemi 1.1.0","title":"inlamemi 1.1.0","text":"CRAN release: 2024-10-31 Added functions extract different sections model, notably get_imputed, extract imputed covariate values. Made informative print method. Made internal functions actually internal. Fixed error Framingham vignette, scaling model 2.5 10^12, 10^-12.","code":""},{"path":"https://emmaskarstein.github.io/inlamemi/news/index.html","id":"inlamemi-100","dir":"Changelog","previous_headings":"","what":"inlamemi 1.0.0","title":"inlamemi 1.0.0","text":"CRAN release: 2024-06-24 Initial CRAN submission.","code":""}]
